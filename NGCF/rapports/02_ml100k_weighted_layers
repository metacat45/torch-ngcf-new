hephaestos@toto:/media/stock/projets/20220130_CNAM_graphs/NGCF-PyTorch-new/NGCF$ python3 main_weighted_layers.py --dataset ml-100k --regs [1e-5] --embed_size 64 --layer_size [64,64,64] --lr 0.0001 --save_flag 1 --pretrain 0 --batch_size 1024 --epoch 50 --verbose 1 --node_dropout [0.1] --mess_dropout [0.1,0.1,0.1] --weights_path "weighted_layers/"
n_users=943, n_items=1682
n_interactions=100000
n_train=90404, n_test=9596, sparsity=0.06305
already load adj matrix (2625, 2625) 0.016438961029052734
Epoch 0 [4.1s]: train==[61.57581=61.57387 + 0.00194]
Epoch 1 [4.1s]: train==[61.38354=61.38160 + 0.00194]
Epoch 2 [4.1s]: train==[60.55336=60.55143 + 0.00194]
Epoch 3 [4.1s]: train==[59.59182=59.58989 + 0.00194]
Epoch 4 [4.1s]: train==[57.03301=57.03107 + 0.00195]
Epoch 5 [4.1s]: train==[51.75229=51.75033 + 0.00196]
Epoch 6 [4.1s]: train==[46.42388=46.42190 + 0.00198]
Epoch 7 [4.1s]: train==[43.13166=43.12966 + 0.00200]
Epoch 8 [4.1s]: train==[41.14911=41.14709 + 0.00202]
Epoch 9 [4.1s + 0.4s]: train==[39.61006=39.60803 + 0.00204], recall=[0.14051, 0.39921], precision=[0.04321, 0.03107], hit=[0.55567, 0.90456], ndcg=[0.09873, 0.18260]
save the weights in path:  weighted_layers/9.pkl
Epoch 10 [4.1s]: train==[38.56826=38.56621 + 0.00205]
Epoch 11 [4.2s]: train==[37.56565=37.56359 + 0.00207]
Epoch 12 [4.1s]: train==[36.71405=36.71197 + 0.00209]
Epoch 13 [4.1s]: train==[35.94807=35.94595 + 0.00210]
Epoch 14 [4.2s]: train==[35.08946=35.08734 + 0.00212]
Epoch 15 [4.1s]: train==[34.27497=34.27283 + 0.00214]
Epoch 16 [4.1s]: train==[33.50323=33.50105 + 0.00216]
Epoch 17 [4.0s]: train==[32.47619=32.47401 + 0.00218]
Epoch 18 [4.0s]: train==[31.85707=31.85488 + 0.00220]
Epoch 19 [4.1s + 0.4s]: train==[31.34631=31.34409 + 0.00222], recall=[0.21150, 0.50172], precision=[0.07354, 0.04084], hit=[0.69353, 0.93955], ndcg=[0.15809, 0.25295]
save the weights in path:  weighted_layers/19.pkl
Epoch 20 [4.0s]: train==[30.80332=30.80108 + 0.00224]
Epoch 21 [4.1s]: train==[30.34896=30.34670 + 0.00226]
Epoch 22 [4.1s]: train==[30.10895=30.10669 + 0.00227]
Epoch 23 [4.1s]: train==[29.56819=29.56589 + 0.00230]
Epoch 24 [4.1s]: train==[28.94574=28.94342 + 0.00232]
Epoch 25 [4.1s]: train==[28.67900=28.67667 + 0.00234]
Epoch 26 [4.1s]: train==[28.08682=28.08446 + 0.00236]
Epoch 27 [4.0s]: train==[27.76093=27.75854 + 0.00238]
Epoch 28 [4.0s]: train==[27.53595=27.53355 + 0.00241]
Epoch 29 [4.0s + 0.4s]: train==[27.18978=27.18735 + 0.00243], recall=[0.23652, 0.55787], precision=[0.08765, 0.04646], hit=[0.73489, 0.96182], ndcg=[0.18514, 0.28951]
save the weights in path:  weighted_layers/29.pkl
Epoch 30 [4.1s]: train==[27.11786=27.11540 + 0.00246]
Epoch 31 [4.0s]: train==[26.68069=26.67823 + 0.00248]
Epoch 32 [4.1s]: train==[26.41163=26.40913 + 0.00251]
Epoch 33 [4.2s]: train==[26.15792=26.15538 + 0.00253]
Epoch 34 [4.1s]: train==[26.04467=26.04211 + 0.00256]
Epoch 35 [4.0s]: train==[25.90593=25.90335 + 0.00258]
Epoch 36 [4.1s]: train==[25.54152=25.53890 + 0.00261]
Epoch 37 [4.0s]: train==[25.13875=25.13610 + 0.00264]
Epoch 38 [4.0s]: train==[24.99896=24.99630 + 0.00267]
Epoch 39 [4.0s + 0.4s]: train==[25.04106=25.03836 + 0.00270], recall=[0.25173, 0.58866], precision=[0.09470, 0.04935], hit=[0.75292, 0.96925], ndcg=[0.19608, 0.30526]
save the weights in path:  weighted_layers/39.pkl
Epoch 40 [4.2s]: train==[24.74390=24.74117 + 0.00273]
Epoch 41 [4.2s]: train==[24.57016=24.56741 + 0.00276]
Epoch 42 [4.2s]: train==[24.21197=24.20919 + 0.00279]
Epoch 43 [4.1s]: train==[24.14742=24.14460 + 0.00282]
Epoch 44 [4.0s]: train==[23.90190=23.89906 + 0.00285]
Epoch 45 [4.0s]: train==[23.64565=23.64277 + 0.00288]
Epoch 46 [4.0s]: train==[23.41498=23.41208 + 0.00291]
Epoch 47 [4.0s]: train==[23.28123=23.27829 + 0.00294]
Epoch 48 [4.0s]: train==[23.15358=23.15062 + 0.00297]
Epoch 49 [4.0s + 0.4s]: train==[23.04788=23.04489 + 0.00299], recall=[0.27370, 0.60790], precision=[0.10710, 0.05232], hit=[0.78897, 0.97667], ndcg=[0.21405, 0.32191]
save the weights in path:  weighted_layers/49.pkl
Best Iter=[4]@[205.8]   recall=[0.27370 0.39486 0.48711 0.55405 0.60790], precision=[0.10710    0.08083 0.06790 0.05885 0.05232], hit=[0.78897  0.89077 0.93425 0.95864 0.97667], ndcg=[0.21405        0.25342 0.28455 0.30569 0.32191]
hephaestos@toto:/media/stock/projets/20220130_CNAM_graphs/NGCF-PyTorch-new/NGCF$ python3 main_weighted_layers.py --dataset ml-100k --regs [1e-5] --embed_size 64 --layer_size [64,64,64] --lr 0.0001 --save_flag 1 --pretrain 0 --batch_size 1024 --epoch 400 --verbose 1 --node_dropout [0.1] --mess_dropout [0.1,0.1,0.1] --weights_path "weighted_layers/"
n_users=943, n_items=1682
n_interactions=100000
n_train=90404, n_test=9596, sparsity=0.06305
already load adj matrix (2625, 2625) 0.016344070434570312
Epoch 0 [4.1s]: train==[61.55768=61.55574 + 0.00194]
Epoch 1 [4.1s]: train==[61.37477=61.37283 + 0.00194]
Epoch 2 [4.0s]: train==[60.65911=60.65717 + 0.00194]
Epoch 3 [4.0s]: train==[59.67663=59.67468 + 0.00194]
Epoch 4 [4.1s]: train==[57.14506=57.14311 + 0.00195]
Epoch 5 [4.1s]: train==[52.08138=52.07942 + 0.00196]
Epoch 6 [4.1s]: train==[46.94566=46.94367 + 0.00198]
Epoch 7 [4.1s]: train==[43.73773=43.73573 + 0.00200]
Epoch 8 [4.1s]: train==[41.33850=41.33648 + 0.00202]
Epoch 9 [4.1s + 0.4s]: train==[39.63415=39.63211 + 0.00204], recall=[0.13355, 0.40061], precision=[0.04162, 0.03110], hit=[0.55355, 0.89714], ndcg=[0.09678, 0.18354]
save the weights in path:  weighted_layers/9.pkl
Epoch 10 [4.2s]: train==[38.56677=38.56472 + 0.00206]
Epoch 11 [4.2s]: train==[37.56813=37.56605 + 0.00208]
Epoch 12 [4.2s]: train==[36.75177=36.74968 + 0.00210]
Epoch 13 [4.2s]: train==[35.85785=35.85574 + 0.00212]
Epoch 14 [4.2s]: train==[35.01353=35.01139 + 0.00214]
Epoch 15 [4.1s]: train==[34.39949=34.39732 + 0.00216]
Epoch 16 [4.1s]: train==[33.63949=33.63731 + 0.00218]
Epoch 17 [4.1s]: train==[33.05841=33.05621 + 0.00220]
Epoch 18 [4.2s]: train==[32.40168=32.39946 + 0.00222]
Epoch 19 [4.0s + 0.4s]: train==[31.68172=31.67949 + 0.00224], recall=[0.21531, 0.49802], precision=[0.07508, 0.04084], hit=[0.70414, 0.93743], ndcg=[0.16142, 0.25401]
save the weights in path:  weighted_layers/19.pkl
Epoch 20 [4.0s]: train==[31.16398=31.16172 + 0.00226]
Epoch 21 [4.2s]: train==[30.69945=30.69716 + 0.00229]
Epoch 22 [4.1s]: train==[30.22071=30.21841 + 0.00231]
Epoch 23 [4.0s]: train==[29.95961=29.95728 + 0.00233]
Epoch 24 [4.0s]: train==[29.34308=29.34073 + 0.00235]
Epoch 25 [4.0s]: train==[28.80431=28.80194 + 0.00237]
Epoch 26 [4.0s]: train==[28.52682=28.52443 + 0.00240]
Epoch 27 [4.0s]: train==[27.98296=27.98054 + 0.00242]
Epoch 28 [4.0s]: train==[27.65195=27.64949 + 0.00245]
Epoch 29 [4.0s + 0.4s]: train==[27.40909=27.40662 + 0.00247], recall=[0.24008, 0.55004], precision=[0.08690, 0.04624], hit=[0.74867, 0.95864], ndcg=[0.18298, 0.28551]
save the weights in path:  weighted_layers/29.pkl
Epoch 30 [4.1s]: train==[27.07691=27.07442 + 0.00250]
Epoch 31 [4.1s]: train==[26.74062=26.73810 + 0.00253]
Epoch 32 [4.0s]: train==[26.47926=26.47671 + 0.00255]
Epoch 33 [4.0s]: train==[26.06509=26.06251 + 0.00258]
Epoch 34 [4.1s]: train==[25.73052=25.72791 + 0.00261]
Epoch 35 [4.1s]: train==[25.56194=25.55931 + 0.00263]
Epoch 36 [4.1s]: train==[25.51562=25.51297 + 0.00266]
Epoch 37 [4.1s]: train==[25.35240=25.34972 + 0.00269]
Epoch 38 [4.1s]: train==[24.92318=24.92046 + 0.00272]
Epoch 39 [4.1s + 0.4s]: train==[24.63936=24.63661 + 0.00274], recall=[0.25659, 0.58915], precision=[0.09602, 0.04984], hit=[0.76882, 0.97137], ndcg=[0.19979, 0.30865]
save the weights in path:  weighted_layers/39.pkl
Epoch 40 [4.2s]: train==[24.44100=24.43822 + 0.00278]
Epoch 41 [4.1s]: train==[24.33998=24.33717 + 0.00281]
Epoch 42 [4.1s]: train==[24.24624=24.24340 + 0.00283]
Epoch 43 [4.2s]: train==[24.00747=24.00460 + 0.00287]
Epoch 44 [4.2s]: train==[23.73034=23.72745 + 0.00289]
Epoch 45 [4.1s]: train==[23.45913=23.45621 + 0.00292]
Epoch 46 [4.1s]: train==[23.42618=23.42322 + 0.00296]
Epoch 47 [4.1s]: train==[23.23959=23.23660 + 0.00299]
Epoch 48 [4.1s]: train==[22.87985=22.87683 + 0.00302]
Epoch 49 [4.1s + 0.4s]: train==[22.86267=22.85963 + 0.00304], recall=[0.27001, 0.60921], precision=[0.10493, 0.05257], hit=[0.79533, 0.97667], ndcg=[0.21303, 0.32340]
save the weights in path:  weighted_layers/49.pkl
Epoch 50 [4.1s]: train==[22.41724=22.41416 + 0.00307]
Epoch 51 [4.1s]: train==[22.52232=22.51921 + 0.00310]
Epoch 52 [4.1s]: train==[22.51705=22.51390 + 0.00313]
Epoch 53 [4.1s]: train==[22.05513=22.05196 + 0.00316]
Epoch 54 [4.1s]: train==[21.90243=21.89923 + 0.00319]
Epoch 55 [4.1s]: train==[21.82672=21.82351 + 0.00322]
Epoch 56 [4.1s]: train==[21.51201=21.50875 + 0.00325]
Epoch 57 [4.1s]: train==[21.51262=21.50934 + 0.00328]
Epoch 58 [4.1s]: train==[21.22407=21.22076 + 0.00331]
Epoch 59 [4.1s + 0.4s]: train==[21.01756=21.01422 + 0.00334], recall=[0.28630, 0.62666], precision=[0.11379, 0.05495], hit=[0.81018, 0.97667], ndcg=[0.22742, 0.33768]
save the weights in path:  weighted_layers/59.pkl
Epoch 60 [4.1s]: train==[20.89827=20.89490 + 0.00337]
Epoch 61 [4.1s]: train==[20.64386=20.64045 + 0.00340]
Epoch 62 [4.1s]: train==[20.57733=20.57391 + 0.00343]
Epoch 63 [4.1s]: train==[20.46219=20.45873 + 0.00346]
Epoch 64 [4.0s]: train==[20.39948=20.39599 + 0.00349]
Epoch 65 [4.1s]: train==[20.09170=20.08820 + 0.00352]
Epoch 66 [4.1s]: train==[19.93044=19.92691 + 0.00354]
Epoch 67 [4.1s]: train==[19.81246=19.80888 + 0.00357]
Epoch 68 [4.1s]: train==[19.82059=19.81699 + 0.00360]
Epoch 69 [4.1s + 0.4s]: train==[19.59995=19.59632 + 0.00363], recall=[0.29204, 0.63702], precision=[0.11787, 0.05615], hit=[0.82291, 0.98197], ndcg=[0.23634, 0.34757]
save the weights in path:  weighted_layers/69.pkl
Epoch 70 [4.1s]: train==[19.60962=19.60595 + 0.00366]
Epoch 71 [4.1s]: train==[19.29085=19.28716 + 0.00369]
Epoch 72 [4.1s]: train==[19.27201=19.26830 + 0.00371]
Epoch 73 [4.1s]: train==[19.11223=19.10850 + 0.00374]
Epoch 74 [4.1s]: train==[19.08895=19.08517 + 0.00378]
Epoch 75 [4.0s]: train==[18.93304=18.92925 + 0.00380]
Epoch 76 [4.1s]: train==[18.80397=18.80014 + 0.00383]
Epoch 77 [4.0s]: train==[18.59346=18.58961 + 0.00385]
Epoch 78 [4.0s]: train==[18.53895=18.53506 + 0.00389]
Epoch 79 [4.0s + 0.4s]: train==[18.66942=18.66551 + 0.00391], recall=[0.29616, 0.64257], precision=[0.12185, 0.05686], hit=[0.82078, 0.98303], ndcg=[0.24454, 0.35523]
save the weights in path:  weighted_layers/79.pkl
Epoch 80 [4.1s]: train==[18.44610=18.44217 + 0.00394]
Epoch 81 [4.1s]: train==[18.28749=18.28353 + 0.00396]
Epoch 82 [4.1s]: train==[18.22927=18.22528 + 0.00399]
Epoch 83 [4.1s]: train==[18.11502=18.11101 + 0.00401]
Epoch 84 [4.0s]: train==[18.03659=18.03255 + 0.00405]
Epoch 85 [4.0s]: train==[17.90329=17.89923 + 0.00406]
Epoch 86 [4.1s]: train==[17.68130=17.67719 + 0.00409]
Epoch 87 [4.1s]: train==[17.74501=17.74088 + 0.00412]
Epoch 88 [4.1s]: train==[17.66062=17.65647 + 0.00415]
Epoch 89 [4.1s + 0.4s]: train==[17.45058=17.44640 + 0.00418], recall=[0.30377, 0.65021], precision=[0.12476, 0.05762], hit=[0.83669, 0.98303], ndcg=[0.25033, 0.36050]
save the weights in path:  weighted_layers/89.pkl
Epoch 90 [4.1s]: train==[17.43384=17.42965 + 0.00419]
Epoch 91 [4.2s]: train==[17.34054=17.33632 + 0.00422]
Epoch 92 [4.2s]: train==[17.24232=17.23808 + 0.00425]
Epoch 93 [4.1s]: train==[17.11740=17.11313 + 0.00427]
Epoch 94 [4.2s]: train==[17.12154=17.11724 + 0.00430]
Epoch 95 [4.3s]: train==[17.06747=17.06316 + 0.00432]
Epoch 96 [4.3s]: train==[17.10528=17.10093 + 0.00434]
Epoch 97 [4.1s]: train==[17.05979=17.05542 + 0.00437]
Epoch 98 [4.1s]: train==[17.07337=17.06898 + 0.00439]
Epoch 99 [4.0s + 0.4s]: train==[16.83913=16.83471 + 0.00442], recall=[0.30539, 0.65598], precision=[0.12678, 0.05809], hit=[0.83669, 0.98515], ndcg=[0.25603, 0.36694]
save the weights in path:  weighted_layers/99.pkl
Epoch 100 [3.9s]: train==[16.68677=16.68232 + 0.00445]
Epoch 101 [3.9s]: train==[16.59456=16.59010 + 0.00447]
Epoch 102 [3.9s]: train==[16.57483=16.57034 + 0.00449]
Epoch 103 [4.0s]: train==[16.29105=16.28654 + 0.00452]
Epoch 104 [3.9s]: train==[16.45414=16.44960 + 0.00454]
Epoch 105 [4.0s]: train==[16.35666=16.35210 + 0.00457]
Epoch 106 [4.1s]: train==[16.21595=16.21137 + 0.00458]
Epoch 107 [4.0s]: train==[16.04708=16.04247 + 0.00461]
Epoch 108 [4.2s]: train==[16.19288=16.18825 + 0.00463]
Epoch 109 [4.0s + 0.4s]: train==[16.10673=16.10207 + 0.00466], recall=[0.31061, 0.66063], precision=[0.12858, 0.05866], hit=[0.84199, 0.98727], ndcg=[0.26076, 0.37189]
save the weights in path:  weighted_layers/109.pkl
Epoch 110 [4.0s]: train==[15.89317=15.88848 + 0.00468]
Epoch 111 [4.0s]: train==[15.88404=15.87933 + 0.00470]
Epoch 112 [3.9s]: train==[15.72898=15.72425 + 0.00473]
Epoch 113 [3.9s]: train==[15.74616=15.74141 + 0.00475]
Epoch 114 [3.9s]: train==[15.69465=15.68987 + 0.00478]
Epoch 115 [3.9s]: train==[15.78366=15.77887 + 0.00480]
Epoch 116 [3.9s]: train==[15.83365=15.82883 + 0.00482]
Epoch 117 [3.9s]: train==[15.49475=15.48991 + 0.00484]
Epoch 118 [3.9s]: train==[15.50585=15.50098 + 0.00487]
Epoch 119 [3.9s + 0.4s]: train==[15.43660=15.43171 + 0.00489], recall=[0.32104, 0.66840], precision=[0.13229, 0.05926], hit=[0.85472, 0.98621], ndcg=[0.26803, 0.37783]
save the weights in path:  weighted_layers/119.pkl
Epoch 120 [3.9s]: train==[15.51785=15.51294 + 0.00491]
Epoch 121 [4.0s]: train==[15.40273=15.39780 + 0.00493]
Epoch 122 [4.0s]: train==[15.19236=15.18740 + 0.00495]
Epoch 123 [4.1s]: train==[15.18848=15.18351 + 0.00497]
Epoch 124 [4.1s]: train==[14.92119=14.91618 + 0.00501]
Epoch 125 [4.0s]: train==[15.17681=15.17179 + 0.00502]
Epoch 126 [4.0s]: train==[15.12632=15.12127 + 0.00504]
Epoch 127 [4.0s]: train==[14.98216=14.97709 + 0.00506]
Epoch 128 [4.0s]: train==[14.98536=14.98026 + 0.00509]
Epoch 129 [4.0s + 0.4s]: train==[14.96882=14.96371 + 0.00511], recall=[0.32551, 0.67366], precision=[0.13409, 0.05977], hit=[0.85260, 0.98621], ndcg=[0.27486, 0.38496]
save the weights in path:  weighted_layers/129.pkl
Epoch 130 [4.0s]: train==[14.78367=14.77853 + 0.00514]
Epoch 131 [4.0s]: train==[14.78362=14.77846 + 0.00516]
Epoch 132 [4.0s]: train==[14.96441=14.95924 + 0.00517]
Epoch 133 [4.0s]: train==[14.58919=14.58398 + 0.00520]
Epoch 134 [4.1s]: train==[14.70316=14.69794 + 0.00522]
Epoch 135 [4.3s]: train==[14.72380=14.71856 + 0.00524]
Epoch 136 [4.2s]: train==[14.36100=14.35572 + 0.00527]
Epoch 137 [4.2s]: train==[14.46197=14.45669 + 0.00528]
Epoch 138 [4.0s]: train==[14.43261=14.42730 + 0.00531]
Epoch 139 [4.0s + 0.4s]: train==[14.32377=14.31844 + 0.00533], recall=[0.32683, 0.68284], precision=[0.13494, 0.06051], hit=[0.85684, 0.98621], ndcg=[0.27799, 0.39051]
save the weights in path:  weighted_layers/139.pkl
Epoch 140 [4.1s]: train==[14.58810=14.58276 + 0.00534]
Epoch 141 [4.0s]: train==[14.27811=14.27273 + 0.00537]
Epoch 142 [4.0s]: train==[14.32078=14.31540 + 0.00538]
Epoch 143 [4.1s]: train==[14.29816=14.29276 + 0.00540]
Epoch 144 [4.1s]: train==[14.06211=14.05668 + 0.00543]
Epoch 145 [4.0s]: train==[14.09665=14.09120 + 0.00545]
Epoch 146 [4.1s]: train==[14.18019=14.17471 + 0.00548]
Epoch 147 [4.2s]: train==[13.93308=13.92759 + 0.00549]
Epoch 148 [4.5s]: train==[13.97895=13.97343 + 0.00552]
Epoch 149 [4.3s + 0.4s]: train==[13.76113=13.75559 + 0.00554], recall=[0.33251, 0.68704], precision=[0.13712, 0.06094], hit=[0.86002, 0.98515], ndcg=[0.28185, 0.39386]
save the weights in path:  weighted_layers/149.pkl
Epoch 150 [4.3s]: train==[13.77178=13.76622 + 0.00555]
Epoch 151 [4.3s]: train==[13.94046=13.93489 + 0.00557]
Epoch 152 [3.9s]: train==[13.70052=13.69492 + 0.00560]
Epoch 153 [3.9s]: train==[13.77533=13.76972 + 0.00561]
Epoch 154 [3.9s]: train==[13.70727=13.70163 + 0.00564]
Epoch 155 [3.9s]: train==[13.75533=13.74967 + 0.00565]
Epoch 156 [3.9s]: train==[13.63739=13.63172 + 0.00567]
Epoch 157 [4.0s]: train==[13.67055=13.66485 + 0.00570]
Epoch 158 [4.1s]: train==[13.45893=13.45321 + 0.00572]
Epoch 159 [4.1s + 0.4s]: train==[13.53263=13.52689 + 0.00574], recall=[0.33738, 0.68948], precision=[0.13802, 0.06135], hit=[0.86850, 0.98515], ndcg=[0.28499, 0.39676]
save the weights in path:  weighted_layers/159.pkl
Epoch 160 [4.0s]: train==[13.41762=13.41186 + 0.00575]
Epoch 161 [4.0s]: train==[13.53228=13.52649 + 0.00578]
Epoch 162 [4.0s]: train==[13.41973=13.41395 + 0.00579]
Epoch 163 [4.0s]: train==[13.47064=13.46482 + 0.00582]
Epoch 164 [4.1s]: train==[13.44235=13.43652 + 0.00583]
Epoch 165 [4.3s]: train==[13.17111=13.16526 + 0.00586]
Epoch 166 [4.0s]: train==[13.28654=13.28068 + 0.00587]
Epoch 167 [4.0s]: train==[13.24451=13.23861 + 0.00590]
Epoch 168 [4.1s]: train==[13.31525=13.30934 + 0.00591]
Epoch 169 [4.1s + 0.4s]: train==[13.20791=13.20197 + 0.00594], recall=[0.34047, 0.69034], precision=[0.13971, 0.06148], hit=[0.86744, 0.98303], ndcg=[0.28895, 0.40001]
save the weights in path:  weighted_layers/169.pkl
Epoch 170 [4.0s]: train==[13.19247=13.18652 + 0.00595]
Epoch 171 [4.0s]: train==[13.12083=13.11486 + 0.00598]
Epoch 172 [4.0s]: train==[13.07426=13.06827 + 0.00599]
Epoch 173 [4.0s]: train==[13.22148=13.21548 + 0.00601]
Epoch 174 [4.0s]: train==[12.93511=12.92909 + 0.00603]
Epoch 175 [4.1s]: train==[12.96684=12.96079 + 0.00605]
Epoch 176 [4.1s]: train==[13.08710=13.08103 + 0.00606]
Epoch 177 [4.0s]: train==[13.01145=13.00536 + 0.00608]
Epoch 178 [4.0s]: train==[12.87571=12.86961 + 0.00610]
Epoch 179 [4.0s + 0.4s]: train==[13.07878=13.07265 + 0.00613], recall=[0.34308, 0.69389], precision=[0.14051, 0.06183], hit=[0.86850, 0.98409], ndcg=[0.29199, 0.40304]
save the weights in path:  weighted_layers/179.pkl
Epoch 180 [4.1s]: train==[12.92062=12.91448 + 0.00614]
Epoch 181 [4.0s]: train==[12.76558=12.75941 + 0.00616]
Epoch 182 [4.1s]: train==[12.58250=12.57631 + 0.00619]
Epoch 183 [4.0s]: train==[12.69755=12.69135 + 0.00620]
Epoch 184 [4.1s]: train==[12.75747=12.75126 + 0.00622]
Epoch 185 [4.0s]: train==[12.70874=12.70250 + 0.00623]
Epoch 186 [4.0s]: train==[12.53673=12.53049 + 0.00625]
Epoch 187 [4.0s]: train==[12.61006=12.60379 + 0.00628]
Epoch 188 [3.9s]: train==[12.59782=12.59152 + 0.00629]
Epoch 189 [4.0s + 0.4s]: train==[12.54139=12.53510 + 0.00629], recall=[0.34238, 0.69310], precision=[0.14088, 0.06198], hit=[0.86957, 0.98409], ndcg=[0.29265, 0.40422]
Epoch 190 [4.1s]: train==[12.54747=12.54115 + 0.00632]
Epoch 191 [3.9s]: train==[12.47859=12.47224 + 0.00634]
Epoch 192 [3.9s]: train==[12.44682=12.44046 + 0.00636]
Epoch 193 [3.9s]: train==[12.59782=12.59145 + 0.00637]
Epoch 194 [3.9s]: train==[12.61261=12.60623 + 0.00638]
Epoch 195 [4.0s]: train==[12.54375=12.53734 + 0.00641]
Epoch 196 [4.0s]: train==[12.30743=12.30100 + 0.00643]
Epoch 197 [4.1s]: train==[12.20734=12.20088 + 0.00646]
Epoch 198 [4.0s]: train==[12.32625=12.31978 + 0.00647]
Epoch 199 [4.2s + 0.4s]: train==[12.30151=12.29501 + 0.00650], recall=[0.34475, 0.69681], precision=[0.14231, 0.06235], hit=[0.86426, 0.98303], ndcg=[0.29617, 0.40800]
save the weights in path:  weighted_layers/199.pkl
Epoch 200 [4.0s]: train==[12.30209=12.29558 + 0.00650]
Epoch 201 [3.9s]: train==[12.24159=12.23507 + 0.00652]
Epoch 202 [4.0s]: train==[12.24320=12.23667 + 0.00653]
Epoch 203 [3.9s]: train==[12.24702=12.24047 + 0.00656]
Epoch 204 [3.9s]: train==[12.30098=12.29441 + 0.00657]
Epoch 205 [3.9s]: train==[12.03361=12.02701 + 0.00660]
Epoch 206 [3.9s]: train==[12.12475=12.11814 + 0.00661]
Epoch 207 [3.9s]: train==[11.87344=11.86680 + 0.00663]
Epoch 208 [4.0s]: train==[12.09247=12.08583 + 0.00665]
Epoch 209 [4.0s + 0.4s]: train==[12.13360=12.12694 + 0.00666], recall=[0.34775, 0.70037], precision=[0.14311, 0.06276], hit=[0.87169, 0.98303], ndcg=[0.30065, 0.41276]
save the weights in path:  weighted_layers/209.pkl
Epoch 210 [4.0s]: train==[11.94879=11.94211 + 0.00668]
Epoch 211 [4.0s]: train==[12.01893=12.01222 + 0.00671]
Epoch 212 [4.2s]: train==[11.97036=11.96364 + 0.00671]
Epoch 213 [4.1s]: train==[11.79169=11.78495 + 0.00674]
Epoch 214 [4.1s]: train==[11.94098=11.93423 + 0.00676]
Epoch 215 [4.1s]: train==[12.03034=12.02357 + 0.00677]
Epoch 216 [4.1s]: train==[11.78068=11.77389 + 0.00679]
Epoch 217 [4.1s]: train==[11.66029=11.65349 + 0.00680]
Epoch 218 [4.1s]: train==[11.97485=11.96803 + 0.00682]
Epoch 219 [4.1s + 0.4s]: train==[11.68942=11.68259 + 0.00683], recall=[0.35186, 0.70190], precision=[0.14475, 0.06294], hit=[0.87487, 0.98303], ndcg=[0.30131, 0.41248]
save the weights in path:  weighted_layers/219.pkl
Epoch 220 [4.1s]: train==[11.86658=11.85972 + 0.00685]
Epoch 221 [4.1s]: train==[11.63571=11.62883 + 0.00688]
Epoch 222 [4.2s]: train==[11.64346=11.63656 + 0.00689]
Epoch 223 [4.2s]: train==[11.59108=11.58418 + 0.00691]
Epoch 224 [4.1s]: train==[11.58046=11.57353 + 0.00692]
Epoch 225 [4.2s]: train==[11.67324=11.66631 + 0.00694]
Epoch 226 [4.1s]: train==[11.68971=11.68277 + 0.00695]
Epoch 227 [4.2s]: train==[11.60662=11.59965 + 0.00697]
Epoch 228 [4.2s]: train==[11.59396=11.58696 + 0.00700]
Epoch 229 [4.1s + 0.4s]: train==[11.50293=11.49592 + 0.00700], recall=[0.35685, 0.70448], precision=[0.14703, 0.06321], hit=[0.88017, 0.98303], ndcg=[0.30633, 0.41648]
save the weights in path:  weighted_layers/229.pkl
Epoch 230 [4.1s]: train==[11.51178=11.50475 + 0.00703]
Epoch 231 [4.1s]: train==[11.39760=11.39055 + 0.00704]
Epoch 232 [4.1s]: train==[11.49501=11.48795 + 0.00706]
Epoch 233 [4.1s]: train==[11.44128=11.43420 + 0.00708]
Epoch 234 [4.2s]: train==[11.38126=11.37416 + 0.00710]
Epoch 235 [4.1s]: train==[11.27520=11.26808 + 0.00712]
Epoch 236 [4.1s]: train==[11.49848=11.49136 + 0.00713]
Epoch 237 [4.1s]: train==[11.29765=11.29051 + 0.00714]
Epoch 238 [4.3s]: train==[11.39828=11.39111 + 0.00717]
Epoch 239 [4.3s + 0.4s]: train==[11.30627=11.29908 + 0.00719], recall=[0.35535, 0.70763], precision=[0.14682, 0.06352], hit=[0.87169, 0.98197], ndcg=[0.30695, 0.41863]
Epoch 240 [4.3s]: train==[11.15161=11.14440 + 0.00721]
Epoch 241 [4.2s]: train==[11.11860=11.11139 + 0.00721]
Epoch 242 [4.1s]: train==[11.13151=11.12427 + 0.00724]
Epoch 243 [4.0s]: train==[11.25300=11.24575 + 0.00725]
Epoch 244 [4.0s]: train==[11.20944=11.20217 + 0.00727]
Epoch 245 [4.1s]: train==[11.38884=11.38156 + 0.00728]
Epoch 246 [4.1s]: train==[10.91321=10.90591 + 0.00729]
Epoch 247 [4.1s]: train==[11.21111=11.20380 + 0.00732]
Epoch 248 [4.1s]: train==[11.02345=11.01611 + 0.00734]
Epoch 249 [4.1s + 0.4s]: train==[11.04945=11.04209 + 0.00736], recall=[0.35728, 0.70712], precision=[0.14719, 0.06376], hit=[0.88123, 0.98197], ndcg=[0.30770, 0.41929]
save the weights in path:  weighted_layers/249.pkl
Epoch 250 [3.9s]: train==[10.94780=10.94042 + 0.00738]
Epoch 251 [3.9s]: train==[10.97112=10.96374 + 0.00738]
Epoch 252 [3.9s]: train==[11.01081=11.00341 + 0.00740]
Epoch 253 [4.0s]: train==[10.92163=10.91419 + 0.00743]
Epoch 254 [4.0s]: train==[10.98429=10.97684 + 0.00745]
Epoch 255 [4.0s]: train==[10.96780=10.96035 + 0.00745]
Epoch 256 [4.0s]: train==[10.84254=10.83507 + 0.00747]
Epoch 257 [4.0s]: train==[10.80225=10.79475 + 0.00749]
Epoch 258 [4.0s]: train==[10.75290=10.74540 + 0.00750]
Epoch 259 [4.0s + 0.4s]: train==[10.80747=10.79996 + 0.00751], recall=[0.35699, 0.71024], precision=[0.14793, 0.06405], hit=[0.87805, 0.98409], ndcg=[0.30812, 0.42062]
Epoch 260 [4.1s]: train==[10.69329=10.68574 + 0.00755]
Epoch 261 [4.0s]: train==[10.65909=10.65154 + 0.00755]
Epoch 262 [4.0s]: train==[10.72155=10.71396 + 0.00758]
Epoch 263 [4.1s]: train==[10.72778=10.72019 + 0.00759]
Epoch 264 [4.0s]: train==[10.58178=10.57418 + 0.00760]
Epoch 265 [4.1s]: train==[10.88373=10.87611 + 0.00762]
Epoch 266 [4.1s]: train==[10.51213=10.50449 + 0.00764]
Epoch 267 [4.0s]: train==[10.52872=10.52106 + 0.00766]
Epoch 268 [4.0s]: train==[10.59832=10.59064 + 0.00768]
Epoch 269 [4.0s + 0.4s]: train==[10.54206=10.53437 + 0.00769], recall=[0.35849, 0.70912], precision=[0.14809, 0.06404], hit=[0.87805, 0.98303], ndcg=[0.31122, 0.42344]
save the weights in path:  weighted_layers/269.pkl
Epoch 270 [4.0s]: train==[10.53811=10.53040 + 0.00771]
Epoch 271 [4.0s]: train==[10.55569=10.54797 + 0.00772]
Epoch 272 [3.9s]: train==[10.61689=10.60916 + 0.00773]
Epoch 273 [3.9s]: train==[10.61502=10.60726 + 0.00775]
Epoch 274 [3.9s]: train==[10.36750=10.35972 + 0.00778]
Epoch 275 [3.9s]: train==[10.54339=10.53559 + 0.00779]
Epoch 276 [3.9s]: train==[10.35100=10.34319 + 0.00781]
Epoch 277 [3.9s]: train==[10.41147=10.40366 + 0.00781]
Epoch 278 [3.9s]: train==[10.48175=10.47391 + 0.00784]
Epoch 279 [3.9s + 0.4s]: train==[10.45264=10.44479 + 0.00785], recall=[0.35989, 0.71154], precision=[0.14878, 0.06449], hit=[0.88123, 0.98515], ndcg=[0.31300, 0.42577]
save the weights in path:  weighted_layers/279.pkl
Epoch 280 [4.0s]: train==[10.54306=10.53519 + 0.00786]
Epoch 281 [4.0s]: train==[10.25513=10.24724 + 0.00789]
Epoch 282 [4.0s]: train==[10.42750=10.41960 + 0.00789]
Epoch 283 [4.0s]: train==[10.31074=10.30282 + 0.00792]
Epoch 284 [4.0s]: train==[10.26920=10.26126 + 0.00794]
Epoch 285 [4.0s]: train==[10.25617=10.24822 + 0.00796]
Epoch 286 [4.0s]: train==[10.08494=10.07697 + 0.00796]
Epoch 287 [4.0s]: train==[10.16291=10.15492 + 0.00799]
Epoch 288 [4.0s]: train==[10.35943=10.35143 + 0.00800]
Epoch 289 [4.0s + 0.4s]: train==[10.17105=10.16304 + 0.00802], recall=[0.36174, 0.71458], precision=[0.14936, 0.06467], hit=[0.88229, 0.98409], ndcg=[0.31461, 0.42761]
save the weights in path:  weighted_layers/289.pkl
Epoch 290 [4.0s]: train==[10.13562=10.12759 + 0.00803]
Epoch 291 [4.0s]: train==[10.12457=10.11652 + 0.00806]
Epoch 292 [4.0s]: train==[10.12914=10.12107 + 0.00806]
Epoch 293 [4.2s]: train==[10.18914=10.18107 + 0.00808]
Epoch 294 [4.0s]: train==[10.22556=10.21747 + 0.00809]
Epoch 295 [4.0s]: train==[9.97022=9.96212 + 0.00811]
Epoch 296 [4.2s]: train==[10.08678=10.07865 + 0.00813]
Epoch 297 [4.1s]: train==[10.02699=10.01885 + 0.00815]
Epoch 298 [4.1s]: train==[10.06091=10.05274 + 0.00817]
Epoch 299 [3.9s + 0.4s]: train==[9.91415=9.90597 + 0.00819], recall=[0.36677, 0.71514], precision=[0.15074, 0.06471], hit=[0.88335, 0.98727], ndcg=[0.31751, 0.42899]
save the weights in path:  weighted_layers/299.pkl
Epoch 300 [4.0s]: train==[10.00882=10.00063 + 0.00819]
Epoch 301 [4.1s]: train==[10.02723=10.01902 + 0.00821]
Epoch 302 [4.1s]: train==[10.08399=10.07577 + 0.00821]
Epoch 303 [4.3s]: train==[9.92229=9.91405 + 0.00824]
Epoch 304 [3.9s]: train==[10.03103=10.02277 + 0.00825]
Epoch 305 [4.0s]: train==[9.95990=9.95163 + 0.00827]
Epoch 306 [4.0s]: train==[9.91708=9.90880 + 0.00829]
Epoch 307 [4.1s]: train==[9.94168=9.93338 + 0.00830]
Epoch 308 [4.0s]: train==[9.80818=9.79986 + 0.00832]
Epoch 309 [4.0s + 0.4s]: train==[9.83114=9.82280 + 0.00835], recall=[0.36411, 0.71944], precision=[0.15016, 0.06506], hit=[0.88229, 0.98834], ndcg=[0.31795, 0.43187]
Epoch 310 [4.1s]: train==[9.80451=9.79616 + 0.00835]
Epoch 311 [4.1s]: train==[9.64040=9.63203 + 0.00837]
Epoch 312 [4.1s]: train==[9.60914=9.60075 + 0.00839]
Epoch 313 [4.2s]: train==[9.87236=9.86395 + 0.00840]
Epoch 314 [4.3s]: train==[9.84251=9.83409 + 0.00842]
Epoch 315 [4.2s]: train==[9.83326=9.82484 + 0.00843]
Epoch 316 [4.1s]: train==[9.68409=9.67564 + 0.00845]
Epoch 317 [4.0s]: train==[9.54766=9.53919 + 0.00847]
Epoch 318 [4.1s]: train==[9.59398=9.58551 + 0.00847]
Epoch 319 [4.0s + 0.4s]: train==[9.62549=9.61700 + 0.00849], recall=[0.36860, 0.72105], precision=[0.15159, 0.06504], hit=[0.88441, 0.98727], ndcg=[0.32025, 0.43265]
save the weights in path:  weighted_layers/319.pkl
Epoch 320 [4.0s]: train==[9.76951=9.76100 + 0.00851]
Epoch 321 [3.9s]: train==[9.59985=9.59131 + 0.00854]
Epoch 322 [3.9s]: train==[9.57794=9.56939 + 0.00855]
Epoch 323 [3.9s]: train==[9.66937=9.66080 + 0.00856]
Epoch 324 [3.9s]: train==[9.48736=9.47878 + 0.00858]
Epoch 325 [3.9s]: train==[9.75518=9.74659 + 0.00859]
Epoch 326 [4.0s]: train==[9.55276=9.54416 + 0.00860]
Epoch 327 [4.0s]: train==[9.31811=9.30949 + 0.00862]
Epoch 328 [4.0s]: train==[9.47242=9.46378 + 0.00864]
Epoch 329 [4.2s + 0.4s]: train==[9.50892=9.50026 + 0.00866], recall=[0.36803, 0.71996], precision=[0.15233, 0.06530], hit=[0.88123, 0.98940], ndcg=[0.32036, 0.43283]
Epoch 330 [4.2s]: train==[9.44667=9.43800 + 0.00867]
Epoch 331 [4.2s]: train==[9.38010=9.37141 + 0.00869]
Epoch 332 [4.1s]: train==[9.46778=9.45908 + 0.00870]
Epoch 333 [4.1s]: train==[9.45984=9.45113 + 0.00871]
Epoch 334 [4.1s]: train==[9.58819=9.57946 + 0.00873]
Epoch 335 [4.1s]: train==[9.25458=9.24583 + 0.00875]
Epoch 336 [4.0s]: train==[9.48286=9.47409 + 0.00877]
Epoch 337 [4.0s]: train==[9.44782=9.43904 + 0.00878]
Epoch 338 [3.9s]: train==[9.37245=9.36365 + 0.00880]
Epoch 339 [4.0s + 0.4s]: train==[9.30116=9.29235 + 0.00881], recall=[0.36793, 0.71892], precision=[0.15249, 0.06517], hit=[0.88441, 0.98834], ndcg=[0.32155, 0.43392]
Epoch 340 [4.0s]: train==[9.24641=9.23757 + 0.00883]
Epoch 341 [4.1s]: train==[9.65626=9.64742 + 0.00884]
Epoch 342 [4.0s]: train==[9.38058=9.37172 + 0.00885]
Epoch 343 [4.0s]: train==[9.22018=9.21130 + 0.00888]
Epoch 344 [4.1s]: train==[9.18352=9.17462 + 0.00890]
Epoch 345 [4.0s]: train==[9.30259=9.29369 + 0.00890]
Epoch 346 [4.0s]: train==[9.10583=9.09691 + 0.00892]
Epoch 347 [4.0s]: train==[9.24928=9.24035 + 0.00893]
Epoch 348 [4.0s]: train==[9.26428=9.25534 + 0.00894]
Epoch 349 [4.0s + 0.4s]: train==[9.04660=9.03763 + 0.00897], recall=[0.37268, 0.72107], precision=[0.15403, 0.06533], hit=[0.88229, 0.98727], ndcg=[0.32288, 0.43408]
save the weights in path:  weighted_layers/349.pkl
Epoch 350 [3.9s]: train==[9.23263=9.22364 + 0.00899]
Epoch 351 [3.9s]: train==[9.16508=9.15607 + 0.00900]
Epoch 352 [4.0s]: train==[9.17357=9.16456 + 0.00902]
Epoch 353 [4.0s]: train==[9.06118=9.05215 + 0.00903]
Epoch 354 [4.1s]: train==[9.22639=9.21733 + 0.00905]
Epoch 355 [4.1s]: train==[9.05165=9.04258 + 0.00907]
Epoch 356 [4.1s]: train==[9.06230=9.05322 + 0.00908]
Epoch 357 [4.0s]: train==[9.12166=9.11256 + 0.00910]
Epoch 358 [4.0s]: train==[8.98277=8.97365 + 0.00912]
Epoch 359 [4.0s + 0.4s]: train==[8.95610=8.94698 + 0.00911], recall=[0.37414, 0.72141], precision=[0.15483, 0.06545], hit=[0.88441, 0.98940], ndcg=[0.32577, 0.43665]
save the weights in path:  weighted_layers/359.pkl
Epoch 360 [3.9s]: train==[9.10528=9.09613 + 0.00915]
Epoch 361 [3.9s]: train==[8.96866=8.95951 + 0.00915]
Epoch 362 [4.0s]: train==[9.07102=9.06184 + 0.00918]
Epoch 363 [4.1s]: train==[8.94725=8.93806 + 0.00919]
Epoch 364 [4.0s]: train==[9.09027=9.08107 + 0.00920]
Epoch 365 [4.0s]: train==[8.94031=8.93110 + 0.00921]
Epoch 366 [4.0s]: train==[8.73313=8.72390 + 0.00923]
Epoch 367 [4.0s]: train==[8.84212=8.83286 + 0.00926]
Epoch 368 [4.0s]: train==[8.84958=8.84032 + 0.00925]
Epoch 369 [4.0s + 0.4s]: train==[8.91282=8.90354 + 0.00928], recall=[0.37091, 0.72314], precision=[0.15376, 0.06562], hit=[0.88335, 0.98834], ndcg=[0.32421, 0.43698]
Epoch 370 [3.9s]: train==[8.78200=8.77271 + 0.00929]
Epoch 371 [4.0s]: train==[8.84931=8.84000 + 0.00931]
Epoch 372 [4.0s]: train==[8.96247=8.95314 + 0.00933]
Epoch 373 [3.9s]: train==[8.86870=8.85935 + 0.00935]
Epoch 374 [4.0s]: train==[8.97114=8.96178 + 0.00936]
Epoch 375 [4.0s]: train==[8.81636=8.80700 + 0.00936]
Epoch 376 [4.0s]: train==[8.73178=8.72239 + 0.00938]
Epoch 377 [4.0s]: train==[8.86201=8.85260 + 0.00941]
Epoch 378 [4.0s]: train==[8.79023=8.78081 + 0.00942]
Epoch 379 [4.0s + 0.4s]: train==[8.98152=8.97209 + 0.00943], recall=[0.37669, 0.72390], precision=[0.15557, 0.06568], hit=[0.88865, 0.98940], ndcg=[0.32783, 0.43863]
save the weights in path:  weighted_layers/379.pkl
Epoch 380 [4.0s]: train==[8.86737=8.85792 + 0.00944]
Epoch 381 [4.1s]: train==[8.78097=8.77150 + 0.00947]
Epoch 382 [4.0s]: train==[8.67062=8.66114 + 0.00948]
Epoch 383 [4.0s]: train==[8.66429=8.65480 + 0.00950]
Epoch 384 [4.0s]: train==[8.66751=8.65799 + 0.00952]
Epoch 385 [4.0s]: train==[8.82388=8.81436 + 0.00952]
Epoch 386 [4.0s]: train==[8.82626=8.81671 + 0.00955]
Epoch 387 [4.1s]: train==[8.72305=8.71350 + 0.00955]
Epoch 388 [4.1s]: train==[8.64381=8.63424 + 0.00957]
Epoch 389 [4.0s + 0.4s]: train==[8.69173=8.68215 + 0.00958], recall=[0.37479, 0.72592], precision=[0.15520, 0.06594], hit=[0.88653, 0.98940], ndcg=[0.32449, 0.43661]
Epoch 390 [4.0s]: train==[8.54170=8.53209 + 0.00960]
Epoch 391 [4.3s]: train==[8.64848=8.63886 + 0.00962]
Epoch 392 [4.1s]: train==[8.66581=8.65617 + 0.00964]
Epoch 393 [4.1s]: train==[8.57572=8.56608 + 0.00964]
Epoch 394 [4.1s]: train==[8.59198=8.58232 + 0.00966]
Epoch 395 [4.0s]: train==[8.38789=8.37821 + 0.00968]
Epoch 396 [4.0s]: train==[8.40042=8.39073 + 0.00969]
Epoch 397 [4.0s]: train==[8.56847=8.55876 + 0.00971]
Epoch 398 [4.0s]: train==[8.47307=8.46334 + 0.00973]
Epoch 399 [4.0s + 0.4s]: train==[8.56229=8.55253 + 0.00975], recall=[0.37659, 0.72614], precision=[0.15551, 0.06600], hit=[0.88653, 0.98940], ndcg=[0.32662, 0.43849]
Best Iter=[37]@[1636.4] recall=[0.37669 0.52261 0.61439 0.67374 0.72390], precision=[0.15557    0.11092 0.08936 0.07536 0.06568], hit=[0.88865  0.95440 0.97773 0.98197 0.98940], ndcg=[0.32783        0.37125 0.40280 0.42277 0.43863]
hephaestos@toto:/media/stock/projets/20220130_CNAM_graphs/NGCF-PyTorch-new/NGCF$ 
