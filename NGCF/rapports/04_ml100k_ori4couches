hephaestos@toto:/media/stock/projets/20220130_CNAM_graphs/NGCF-PyTorch-new/NGCF$ python3 main.py --dataset ml-100k --regs [1e-5] --embed_size 64 --layer_size [64,64,64,64] --lr 0.0001 --save_flag 1 --pretrain 0 --batch_size 1024 --epoch 100 --verbose 1 --node_dropout [0.1] --mess_dropout [0.1,0.1,0.1,0.1] --weights_path "models/ml100k/04_ori4couches/"
n_users=943, n_items=1682
n_interactions=100000
n_train=90404, n_test=9596, sparsity=0.06305
already load adj matrix (2625, 2625) 0.01751708984375
Epoch 0 [4.4s]: train==[60.79251=60.78706 + 0.00546]
Epoch 1 [4.3s]: train==[57.40149=57.39603 + 0.00546]
Epoch 2 [4.3s]: train==[53.61729=53.61183 + 0.00547]
Epoch 3 [4.3s]: train==[50.85530=50.84984 + 0.00547]
Epoch 4 [4.3s]: train==[44.83025=44.82477 + 0.00548]
Epoch 5 [4.3s]: train==[39.02614=39.02064 + 0.00550]
Epoch 6 [4.3s]: train==[35.95836=35.95284 + 0.00552]
Epoch 7 [4.3s]: train==[34.06720=34.06166 + 0.00553]
Epoch 8 [4.3s]: train==[32.33118=32.32564 + 0.00554]
Epoch 9 [4.3s + 0.4s]: train==[31.00757=31.00203 + 0.00555], recall=[0.13919, 0.41759], precision=[0.04799, 0.03263], hit=[0.56204, 0.87381], ndcg=[0.09618, 0.18454]
save the weights in path:  models/ml100k/04_ori4couches/9.pkl
Epoch 10 [4.3s]: train==[30.03518=30.02962 + 0.00557]
Epoch 11 [4.3s]: train==[29.05800=29.05241 + 0.00558]
Epoch 12 [4.3s]: train==[28.23517=28.22959 + 0.00559]
Epoch 13 [4.3s]: train==[27.46122=27.45562 + 0.00560]
Epoch 14 [4.3s]: train==[27.09524=27.08963 + 0.00561]
Epoch 15 [4.3s]: train==[26.28669=26.28106 + 0.00562]
Epoch 16 [4.3s]: train==[25.77216=25.76653 + 0.00563]
Epoch 17 [4.3s]: train==[25.32946=25.32381 + 0.00565]
Epoch 18 [4.3s]: train==[24.89187=24.88621 + 0.00566]
Epoch 19 [4.3s + 0.4s]: train==[24.49854=24.49286 + 0.00567], recall=[0.19990, 0.52963], precision=[0.07010, 0.04304], hit=[0.67232, 0.94380], ndcg=[0.13634, 0.24424]
save the weights in path:  models/ml100k/04_ori4couches/19.pkl
Epoch 20 [4.3s]: train==[24.10667=24.10099 + 0.00568]
Epoch 21 [4.3s]: train==[23.81453=23.80884 + 0.00569]
Epoch 22 [4.3s]: train==[23.50150=23.49579 + 0.00570]
Epoch 23 [4.3s]: train==[23.11491=23.10920 + 0.00571]
Epoch 24 [4.3s]: train==[22.84187=22.83614 + 0.00572]
Epoch 25 [4.3s]: train==[22.81690=22.81117 + 0.00573]
Epoch 26 [4.3s]: train==[22.45672=22.45097 + 0.00574]
Epoch 27 [4.3s]: train==[22.21728=22.21153 + 0.00575]
Epoch 28 [4.3s]: train==[22.04710=22.04133 + 0.00576]
Epoch 29 [4.3s + 0.4s]: train==[21.81597=21.81020 + 0.00577], recall=[0.21259, 0.56892], precision=[0.07598, 0.04740], hit=[0.71898, 0.95758], ndcg=[0.15040, 0.26879]
save the weights in path:  models/ml100k/04_ori4couches/29.pkl
Epoch 30 [4.3s]: train==[21.80537=21.79958 + 0.00578]
Epoch 31 [4.3s]: train==[21.36882=21.36303 + 0.00580]
Epoch 32 [4.3s]: train==[21.26763=21.26182 + 0.00580]
Epoch 33 [4.3s]: train==[21.14515=21.13933 + 0.00581]
Epoch 34 [4.3s]: train==[21.06075=21.05493 + 0.00582]
Epoch 35 [4.3s]: train==[21.10881=21.10298 + 0.00584]
Epoch 36 [4.3s]: train==[20.77190=20.76605 + 0.00584]
Epoch 37 [4.3s]: train==[20.92133=20.91547 + 0.00585]
Epoch 38 [4.3s]: train==[20.62616=20.62029 + 0.00586]
Epoch 39 [4.3s + 0.4s]: train==[20.38213=20.37626 + 0.00587], recall=[0.22791, 0.59546], precision=[0.08128, 0.04946], hit=[0.74019, 0.97455], ndcg=[0.16124, 0.28302]
save the weights in path:  models/ml100k/04_ori4couches/39.pkl
Epoch 40 [4.3s]: train==[20.47145=20.46557 + 0.00588]
Epoch 41 [4.3s]: train==[20.44916=20.44327 + 0.00589]
Epoch 42 [4.3s]: train==[20.01970=20.01379 + 0.00590]
Epoch 43 [4.3s]: train==[20.04501=20.03909 + 0.00591]
Epoch 44 [4.3s]: train==[19.91498=19.90906 + 0.00592]
Epoch 45 [4.3s]: train==[19.84607=19.84013 + 0.00593]
Epoch 46 [4.3s]: train==[19.64242=19.63647 + 0.00595]
Epoch 47 [4.3s]: train==[19.85108=19.84513 + 0.00595]
Epoch 48 [4.3s]: train==[19.59058=19.58463 + 0.00596]
Epoch 49 [4.3s + 0.4s]: train==[19.60879=19.60282 + 0.00597], recall=[0.23712, 0.61077], precision=[0.08934, 0.05133], hit=[0.74973, 0.97773], ndcg=[0.17982, 0.30182]
save the weights in path:  models/ml100k/04_ori4couches/49.pkl
Epoch 50 [4.3s]: train==[19.50730=19.50131 + 0.00598]
Epoch 51 [4.3s]: train==[19.24092=19.23492 + 0.00599]
Epoch 52 [4.3s]: train==[19.16243=19.15643 + 0.00600]
Epoch 53 [4.3s]: train==[19.12830=19.12227 + 0.00602]
Epoch 54 [4.3s]: train==[19.06444=19.05841 + 0.00603]
Epoch 55 [4.4s]: train==[18.99102=18.98498 + 0.00604]
Epoch 56 [4.4s]: train==[18.91049=18.90445 + 0.00605]
Epoch 57 [4.3s]: train==[18.66116=18.65511 + 0.00606]
Epoch 58 [4.3s]: train==[18.62634=18.62026 + 0.00607]
Epoch 59 [4.4s + 0.4s]: train==[18.54042=18.53433 + 0.00608], recall=[0.25220, 0.62191], precision=[0.09475, 0.05281], hit=[0.77306, 0.97879], ndcg=[0.19062, 0.31135]
save the weights in path:  models/ml100k/04_ori4couches/59.pkl
Epoch 60 [4.4s]: train==[18.53257=18.52648 + 0.00609]
Epoch 61 [4.3s]: train==[18.47166=18.46555 + 0.00611]
Epoch 62 [4.3s]: train==[18.42562=18.41951 + 0.00612]
Epoch 63 [4.3s]: train==[18.41036=18.40423 + 0.00613]
Epoch 64 [4.3s]: train==[18.32553=18.31939 + 0.00614]
Epoch 65 [4.3s]: train==[17.98771=17.98156 + 0.00615]
Epoch 66 [4.3s]: train==[18.07714=18.07098 + 0.00616]
Epoch 67 [4.3s]: train==[17.91480=17.90863 + 0.00617]
Epoch 68 [4.3s]: train==[17.96712=17.96093 + 0.00618]
Epoch 69 [4.3s + 0.4s]: train==[17.71441=17.70822 + 0.00620], recall=[0.26103, 0.62976], precision=[0.09926, 0.05388], hit=[0.78155, 0.97879], ndcg=[0.19672, 0.31726]
save the weights in path:  models/ml100k/04_ori4couches/69.pkl
Epoch 70 [4.4s]: train==[17.96285=17.95664 + 0.00621]
Epoch 71 [4.4s]: train==[17.73737=17.73116 + 0.00622]
Epoch 72 [4.4s]: train==[17.80757=17.80133 + 0.00623]
Epoch 73 [4.3s]: train==[17.74901=17.74276 + 0.00625]
Epoch 74 [4.3s]: train==[17.48021=17.47395 + 0.00626]
Epoch 75 [4.3s]: train==[17.22043=17.21417 + 0.00627]
Epoch 76 [4.3s]: train==[17.40054=17.39426 + 0.00628]
Epoch 77 [4.3s]: train==[17.30640=17.30011 + 0.00629]
Epoch 78 [4.3s]: train==[17.21832=17.21201 + 0.00631]
Epoch 79 [4.3s + 0.4s]: train==[16.90965=16.90333 + 0.00632], recall=[0.27234, 0.64931], precision=[0.10520, 0.05574], hit=[0.79427, 0.98515], ndcg=[0.20959, 0.33192]
save the weights in path:  models/ml100k/04_ori4couches/79.pkl
Epoch 80 [4.3s]: train==[17.09368=17.08734 + 0.00633]
Epoch 81 [4.4s]: train==[16.85113=16.84478 + 0.00634]
Epoch 82 [4.4s]: train==[16.77242=16.76607 + 0.00635]
Epoch 83 [4.4s]: train==[16.72545=16.71908 + 0.00637]
Epoch 84 [4.3s]: train==[16.49988=16.49350 + 0.00639]
Epoch 85 [4.3s]: train==[16.56018=16.55378 + 0.00640]
Epoch 86 [4.3s]: train==[16.53182=16.52542 + 0.00641]
Epoch 87 [4.3s]: train==[16.44989=16.44347 + 0.00642]
Epoch 88 [4.3s]: train==[16.44279=16.43636 + 0.00643]
Epoch 89 [4.3s + 0.4s]: train==[16.28543=16.27898 + 0.00645], recall=[0.28631, 0.65235], precision=[0.10801, 0.05619], hit=[0.81972, 0.98409], ndcg=[0.22534, 0.34567]
save the weights in path:  models/ml100k/04_ori4couches/89.pkl
Epoch 90 [4.4s]: train==[16.36144=16.35498 + 0.00646]
Epoch 91 [4.3s]: train==[16.31848=16.31200 + 0.00647]
Epoch 92 [4.3s]: train==[16.24380=16.23733 + 0.00648]
Epoch 93 [4.3s]: train==[16.16530=16.15880 + 0.00650]
Epoch 94 [4.3s]: train==[15.96151=15.95501 + 0.00651]
Epoch 95 [4.3s]: train==[16.11696=16.11044 + 0.00652]
Epoch 96 [4.3s]: train==[16.03900=16.03247 + 0.00654]
Epoch 97 [4.3s]: train==[16.12872=16.12217 + 0.00655]
Epoch 98 [4.4s]: train==[15.95359=15.94702 + 0.00657]
Epoch 99 [4.4s + 0.4s]: train==[15.74079=15.73421 + 0.00658], recall=[0.29154, 0.65333], precision=[0.11166, 0.05628], hit=[0.83351, 0.98197], ndcg=[0.23281, 0.35098]
save the weights in path:  models/ml100k/04_ori4couches/99.pkl
Best Iter=[9]@[435.8]   recall=[0.29154 0.42442 0.52952 0.60503 0.65333], precision=[0.11166    0.08624 0.07310 0.06404 0.05628], hit=[0.83351  0.92153 0.96076 0.97243 0.98197], ndcg=[0.23281        0.27656 0.31151 0.33580 0.35098]
hephaestos@toto:/media/stock/projets/20220130_CNAM_graphs/NGCF-PyTorch-new/NGCF$ 
