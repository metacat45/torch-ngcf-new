hephaestos@toto:/media/stock/projets/20220130_CNAM_graphs/NGCF-PyTorch-new/NGCF$ python3 main.py --dataset ml-100k-connected --regs [1e-5] --embed_size 64 --layer_size [64,64,64] --lr 0.0001 --save_flag 1 --pretrain 0 --batch_size 1024 --epoch 100 --verbose 1 --node_dropout [0.1] --mess_dropout [0.1,0.1,0.1] --weights_path "models/ml100k-connected/06_ori/"
n_users=944, n_items=1682
n_interactions=101682
n_train=91918, n_test=9764, sparsity=0.06404
already load adj matrix (2626, 2626) 0.06507134437561035
Epoch 0 [4.4s]: train==[62.10064=62.09647 + 0.00417]
Epoch 1 [4.4s]: train==[61.47448=61.47032 + 0.00417]
Epoch 2 [4.4s]: train==[56.33820=56.33403 + 0.00418]
Epoch 3 [4.4s]: train==[46.84794=46.84376 + 0.00419]
Epoch 4 [4.4s]: train==[39.52863=39.52443 + 0.00420]
Epoch 5 [4.3s]: train==[36.19818=36.19397 + 0.00421]
Epoch 6 [4.2s]: train==[34.38437=34.38015 + 0.00423]
Epoch 7 [4.3s]: train==[33.03714=33.03291 + 0.00424]
Epoch 8 [4.3s]: train==[32.04646=32.04221 + 0.00425]
Epoch 9 [4.3s + 0.4s]: train==[31.39409=31.38983 + 0.00426], recall=[0.15867, 0.44789], precision=[0.05408, 0.03570], hit=[0.59958, 0.90254], ndcg=[0.11053, 0.20337]
save the weights in path:  models/ml100k-connected/06_ori/9.pkl
Epoch 10 [4.3s]: train==[30.60995=30.60567 + 0.00427]
Epoch 11 [4.3s]: train==[29.64753=29.64324 + 0.00429]
Epoch 12 [4.3s]: train==[28.90592=28.90162 + 0.00430]
Epoch 13 [4.3s]: train==[28.23944=28.23513 + 0.00431]
Epoch 14 [4.3s]: train==[27.34308=27.33876 + 0.00432]
Epoch 15 [4.3s]: train==[26.64441=26.64007 + 0.00434]
Epoch 16 [4.4s]: train==[26.05732=26.05296 + 0.00435]
Epoch 17 [4.3s]: train==[25.44327=25.43891 + 0.00437]
Epoch 18 [4.3s]: train==[24.99008=24.98570 + 0.00438]
Epoch 19 [4.3s + 0.4s]: train==[24.77956=24.77516 + 0.00439], recall=[0.22282, 0.56829], precision=[0.08130, 0.04880], hit=[0.72775, 0.94068], ndcg=[0.16236, 0.27695]
save the weights in path:  models/ml100k-connected/06_ori/19.pkl
Epoch 20 [4.3s]: train==[24.21232=24.20791 + 0.00441]
Epoch 21 [4.2s]: train==[23.60254=23.59811 + 0.00442]
Epoch 22 [4.3s]: train==[23.55901=23.55458 + 0.00444]
Epoch 23 [4.3s]: train==[23.39620=23.39174 + 0.00445]
Epoch 24 [4.2s]: train==[23.03352=23.02905 + 0.00447]
Epoch 25 [4.3s]: train==[22.83276=22.82827 + 0.00448]
Epoch 26 [4.3s]: train==[22.87513=22.87063 + 0.00450]
Epoch 27 [4.2s]: train==[22.56466=22.56016 + 0.00451]
Epoch 28 [4.2s]: train==[22.50241=22.49788 + 0.00453]
Epoch 29 [4.3s + 0.3s]: train==[22.26083=22.25630 + 0.00454], recall=[0.23755, 0.58406], precision=[0.08851, 0.05032], hit=[0.73411, 0.95445], ndcg=[0.17565, 0.28969]
save the weights in path:  models/ml100k-connected/06_ori/29.pkl
Epoch 30 [4.3s]: train==[22.11013=22.10557 + 0.00456]
Epoch 31 [4.2s]: train==[22.13457=22.13000 + 0.00457]
Epoch 32 [4.3s]: train==[21.85134=21.84675 + 0.00458]
Epoch 33 [4.3s]: train==[21.73223=21.72763 + 0.00460]
Epoch 34 [4.3s]: train==[21.44875=21.44415 + 0.00461]
Epoch 35 [4.3s]: train==[21.67916=21.67453 + 0.00463]
Epoch 36 [4.3s]: train==[21.31653=21.31189 + 0.00464]
Epoch 37 [4.3s]: train==[21.48087=21.47621 + 0.00466]
Epoch 38 [4.2s]: train==[21.35624=21.35157 + 0.00467]
Epoch 39 [4.3s + 0.4s]: train==[21.16308=21.15840 + 0.00469], recall=[0.25111, 0.59813], precision=[0.09359, 0.05158], hit=[0.75424, 0.95763], ndcg=[0.18416, 0.29762]
save the weights in path:  models/ml100k-connected/06_ori/39.pkl
Epoch 40 [4.3s]: train==[21.01959=21.01489 + 0.00470]
Epoch 41 [4.2s]: train==[20.95048=20.94577 + 0.00471]
Epoch 42 [4.3s]: train==[20.69211=20.68738 + 0.00473]
Epoch 43 [4.3s]: train==[20.85174=20.84699 + 0.00474]
Epoch 44 [4.3s]: train==[20.48995=20.48519 + 0.00476]
Epoch 45 [4.3s]: train==[20.81306=20.80828 + 0.00478]
Epoch 46 [4.3s]: train==[20.59514=20.59035 + 0.00479]
Epoch 47 [4.3s]: train==[20.38470=20.37989 + 0.00481]
Epoch 48 [4.2s]: train==[20.55286=20.54804 + 0.00482]
Epoch 49 [4.3s + 0.4s]: train==[20.46735=20.46252 + 0.00484], recall=[0.25492, 0.60259], precision=[0.09327, 0.05234], hit=[0.77225, 0.96398], ndcg=[0.18709, 0.30348]
save the weights in path:  models/ml100k-connected/06_ori/49.pkl
Epoch 50 [4.2s]: train==[20.27568=20.27082 + 0.00485]
Epoch 51 [4.3s]: train==[20.02164=20.01678 + 0.00487]
Epoch 52 [4.2s]: train==[19.86601=19.86113 + 0.00488]
Epoch 53 [4.2s]: train==[19.99512=19.99023 + 0.00490]
Epoch 54 [4.3s]: train==[19.94475=19.93984 + 0.00491]
Epoch 55 [4.3s]: train==[19.60498=19.60006 + 0.00492]
Epoch 56 [4.3s]: train==[19.86789=19.86296 + 0.00494]
Epoch 57 [4.3s]: train==[19.60820=19.60325 + 0.00496]
Epoch 58 [4.2s]: train==[19.64241=19.63744 + 0.00497]
Epoch 59 [4.2s + 0.4s]: train==[19.59056=19.58558 + 0.00498], recall=[0.26862, 0.62199], precision=[0.10016, 0.05394], hit=[0.79343, 0.97352], ndcg=[0.19924, 0.31530]
save the weights in path:  models/ml100k-connected/06_ori/59.pkl
Epoch 60 [4.3s]: train==[19.40225=19.39724 + 0.00500]
Epoch 61 [4.3s]: train==[19.35673=19.35172 + 0.00501]
Epoch 62 [4.3s]: train==[19.24472=19.23969 + 0.00504]
Epoch 63 [4.2s]: train==[19.12078=19.11572 + 0.00505]
Epoch 64 [4.3s]: train==[19.10336=19.09829 + 0.00506]
Epoch 65 [4.3s]: train==[18.92579=18.92070 + 0.00508]
Epoch 66 [4.3s]: train==[18.91339=18.90829 + 0.00509]
Epoch 67 [4.2s]: train==[18.77987=18.77477 + 0.00511]
Epoch 68 [4.3s]: train==[19.07470=19.06957 + 0.00513]
Epoch 69 [4.3s + 0.4s]: train==[18.84604=18.84088 + 0.00514], recall=[0.27398, 0.63281], precision=[0.10323, 0.05535], hit=[0.81038, 0.97352], ndcg=[0.20646, 0.32484]
save the weights in path:  models/ml100k-connected/06_ori/69.pkl
Epoch 70 [4.2s]: train==[18.69599=18.69083 + 0.00515]
Epoch 71 [4.2s]: train==[18.74724=18.74206 + 0.00518]
Epoch 72 [4.3s]: train==[18.46514=18.45995 + 0.00519]
Epoch 73 [4.2s]: train==[18.20726=18.20205 + 0.00521]
Epoch 74 [4.2s]: train==[18.12906=18.12384 + 0.00523]
Epoch 75 [4.2s]: train==[18.20846=18.20321 + 0.00524]
Epoch 76 [4.2s]: train==[18.02781=18.02255 + 0.00526]
Epoch 77 [4.3s]: train==[18.19769=18.19243 + 0.00527]
Epoch 78 [4.2s]: train==[17.89693=17.89165 + 0.00529]
Epoch 79 [4.2s + 0.4s]: train==[18.06633=18.06103 + 0.00530], recall=[0.29235, 0.64028], precision=[0.11006, 0.05667], hit=[0.83686, 0.97458], ndcg=[0.22182, 0.33722]
save the weights in path:  models/ml100k-connected/06_ori/79.pkl
Epoch 80 [4.3s]: train==[17.93304=17.92772 + 0.00532]
Epoch 81 [4.3s]: train==[17.62150=17.61616 + 0.00534]
Epoch 82 [4.3s]: train==[17.56334=17.55799 + 0.00535]
Epoch 83 [4.3s]: train==[17.51381=17.50844 + 0.00537]
Epoch 84 [4.3s]: train==[17.39734=17.39195 + 0.00539]
Epoch 85 [4.3s]: train==[17.52675=17.52136 + 0.00540]
Epoch 86 [4.2s]: train==[17.31845=17.31302 + 0.00542]
Epoch 87 [4.3s]: train==[17.17307=17.16763 + 0.00543]
Epoch 88 [4.3s]: train==[17.33795=17.33250 + 0.00544]
Epoch 89 [4.2s + 0.4s]: train==[17.02966=17.02420 + 0.00547], recall=[0.30074, 0.65247], precision=[0.11541, 0.05814], hit=[0.84004, 0.98199], ndcg=[0.23568, 0.35193]
save the weights in path:  models/ml100k-connected/06_ori/89.pkl
Epoch 90 [4.3s]: train==[17.25232=17.24684 + 0.00548]
Epoch 91 [4.3s]: train==[16.82046=16.81496 + 0.00550]
Epoch 92 [4.2s]: train==[16.89688=16.89136 + 0.00552]
Epoch 93 [4.3s]: train==[16.84525=16.83971 + 0.00553]
Epoch 94 [4.3s]: train==[16.76054=16.75499 + 0.00555]
Epoch 95 [4.3s]: train==[16.68419=16.67862 + 0.00557]
Epoch 96 [4.3s]: train==[16.52641=16.52083 + 0.00558]
Epoch 97 [4.3s]: train==[16.45633=16.45072 + 0.00561]
Epoch 98 [4.3s]: train==[16.45205=16.44643 + 0.00562]
Epoch 99 [4.3s + 0.4s]: train==[16.52406=16.51842 + 0.00564], recall=[0.30992, 0.66391], precision=[0.11758, 0.05878], hit=[0.85275, 0.98305], ndcg=[0.24148, 0.35869]
save the weights in path:  models/ml100k-connected/06_ori/99.pkl
Best Iter=[9]@[431.1]   recall=[0.30992 0.44812 0.53842 0.60882 0.66391], precision=[0.11758    0.09158 0.07587 0.06570 0.05878], hit=[0.85275  0.92479 0.95657 0.97564 0.98305], ndcg=[0.24148        0.28796 0.31871 0.34117 0.35869]
hephaestos@toto:/media/stock/projets/20220130_CNAM_graphs/NGCF-PyTorch-new/NGCF$ 