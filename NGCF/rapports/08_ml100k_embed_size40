hephaestos@toto:/media/stock/projets/20220130_CNAM_graphs/NGCF-PyTorch-new/NGCF$ python3 main.py --dataset ml-100k --regs [1e-5] --embed_size 40 --layer_size [64,64,64] --lr 0.0001 --save_flag 0 --pretrain 0 --batch_size 1024 --epoch 150 --verbose 1 --node_dropout [0.1] --mess_dropout [0.1,0.1,0.1]
n_users=943, n_items=1682
n_interactions=100000
n_train=90404, n_test=9596, sparsity=0.06305
already load adj matrix (2625, 2625) 0.18716025352478027
Epoch 0 [4.2s]: train==[61.24078=61.23671 + 0.00408]
Epoch 1 [4.0s]: train==[60.42816=60.42408 + 0.00408]
Epoch 2 [4.0s]: train==[55.77597=55.77188 + 0.00408]
Epoch 3 [4.0s]: train==[52.65400=52.64991 + 0.00409]
Epoch 4 [4.1s]: train==[48.70659=48.70250 + 0.00409]
Epoch 5 [6.3s]: train==[43.80457=43.80046 + 0.00410]
Epoch 6 [4.0s]: train==[40.47600=40.47189 + 0.00412]
Epoch 7 [4.0s]: train==[38.20889=38.20476 + 0.00413]
Epoch 8 [4.0s]: train==[36.48050=36.47636 + 0.00414]
Epoch 9 [4.0s + 0.3s]: train==[35.22706=35.22291 + 0.00415], recall=[0.11795, 0.37427], precision=[0.03706, 0.02761], hit=[0.50477, 0.86426], ndcg=[0.07909, 0.15892]
Epoch 10 [4.0s]: train==[34.04208=34.03791 + 0.00416]
Epoch 11 [4.0s]: train==[33.07999=33.07582 + 0.00418]
Epoch 12 [4.1s]: train==[32.28764=32.28345 + 0.00419]
Epoch 13 [4.1s]: train==[31.45560=31.45140 + 0.00420]
Epoch 14 [4.1s]: train==[30.50341=30.49919 + 0.00421]
Epoch 15 [4.1s]: train==[29.74603=29.74180 + 0.00423]
Epoch 16 [4.1s]: train==[28.87292=28.86869 + 0.00424]
Epoch 17 [4.2s]: train==[28.27969=28.27544 + 0.00425]
Epoch 18 [4.1s]: train==[27.63720=27.63294 + 0.00427]
Epoch 19 [4.1s + 0.3s]: train==[27.06267=27.05839 + 0.00428], recall=[0.20064, 0.53215], precision=[0.06888, 0.04341], hit=[0.67126, 0.95228], ndcg=[0.14442, 0.25367]
Epoch 20 [4.2s]: train==[26.24185=26.23756 + 0.00429]
Epoch 21 [4.2s]: train==[26.03672=26.03241 + 0.00431]
Epoch 22 [4.2s]: train==[25.71750=25.71318 + 0.00432]
Epoch 23 [4.1s]: train==[25.03997=25.03564 + 0.00433]
Epoch 24 [4.1s]: train==[24.94980=24.94546 + 0.00435]
Epoch 25 [4.2s]: train==[24.68157=24.67722 + 0.00436]
Epoch 26 [4.2s]: train==[24.39790=24.39353 + 0.00437]
Epoch 27 [4.1s]: train==[24.11053=24.10615 + 0.00439]
Epoch 28 [4.1s]: train==[24.00423=23.99983 + 0.00440]
Epoch 29 [4.2s + 0.4s]: train==[23.69552=23.69111 + 0.00441], recall=[0.22135, 0.56759], precision=[0.07747, 0.04652], hit=[0.70626, 0.96288], ndcg=[0.15845, 0.27242]
Epoch 30 [4.1s]: train==[23.25414=23.24971 + 0.00443]
Epoch 31 [4.1s]: train==[23.24800=23.24357 + 0.00444]
Epoch 32 [4.1s]: train==[22.93104=22.92658 + 0.00445]
Epoch 33 [4.1s]: train==[22.79156=22.78709 + 0.00447]
Epoch 34 [4.1s]: train==[22.79765=22.79317 + 0.00448]
Epoch 35 [4.3s]: train==[22.67165=22.66716 + 0.00449]
Epoch 36 [6.9s]: train==[22.48143=22.47692 + 0.00450]
Epoch 37 [4.1s]: train==[22.33016=22.32564 + 0.00452]
Epoch 38 [4.2s]: train==[22.05208=22.04755 + 0.00453]
Epoch 39 [4.3s + 0.5s]: train==[22.26312=22.25857 + 0.00454], recall=[0.23309, 0.58870], precision=[0.08213, 0.04825], hit=[0.73595, 0.96925], ndcg=[0.16535, 0.28250]
Epoch 40 [4.3s]: train==[21.88835=21.88380 + 0.00456]
Epoch 41 [4.1s]: train==[21.59748=21.59291 + 0.00457]
Epoch 42 [4.1s]: train==[21.43834=21.43376 + 0.00458]
Epoch 43 [4.1s]: train==[21.61595=21.61135 + 0.00459]
Epoch 44 [4.1s]: train==[21.31712=21.31252 + 0.00461]
Epoch 45 [4.1s]: train==[21.18046=21.17585 + 0.00462]
Epoch 46 [4.1s]: train==[21.32752=21.32288 + 0.00463]
Epoch 47 [4.1s]: train==[21.08280=21.07816 + 0.00465]
Epoch 48 [4.1s]: train==[21.00692=21.00225 + 0.00466]
Epoch 49 [4.1s + 0.3s]: train==[21.11400=21.10934 + 0.00467], recall=[0.24195, 0.59934], precision=[0.08515, 0.05003], hit=[0.74125, 0.97031], ndcg=[0.17704, 0.29579]
Epoch 50 [4.1s]: train==[20.78227=20.77759 + 0.00469]
Epoch 51 [4.1s]: train==[21.02171=21.01701 + 0.00470]
Epoch 52 [4.1s]: train==[20.59450=20.58979 + 0.00471]
Epoch 53 [4.1s]: train==[20.59904=20.59432 + 0.00472]
Epoch 54 [4.1s]: train==[20.41325=20.40851 + 0.00474]
Epoch 55 [4.1s]: train==[20.46188=20.45713 + 0.00475]
Epoch 56 [4.1s]: train==[20.56522=20.56045 + 0.00477]
Epoch 57 [4.1s]: train==[20.28994=20.28516 + 0.00478]
Epoch 58 [4.1s]: train==[19.90637=19.90158 + 0.00479]
Epoch 59 [4.1s + 0.3s]: train==[19.99127=19.98647 + 0.00480], recall=[0.25786, 0.61334], precision=[0.09168, 0.05143], hit=[0.77306, 0.97243], ndcg=[0.19086, 0.30895]
Epoch 60 [4.1s]: train==[20.11421=20.10939 + 0.00482]
Epoch 61 [4.0s]: train==[19.84178=19.83694 + 0.00483]
Epoch 62 [4.1s]: train==[19.97517=19.97032 + 0.00484]
Epoch 63 [4.1s]: train==[19.66575=19.66089 + 0.00486]
Epoch 64 [4.1s]: train==[19.51015=19.50529 + 0.00487]
Epoch 65 [4.0s]: train==[19.50825=19.50338 + 0.00488]
Epoch 66 [4.0s]: train==[19.35909=19.35419 + 0.00489]
Epoch 67 [4.0s]: train==[19.31818=19.31328 + 0.00491]
Epoch 68 [4.1s]: train==[19.26838=19.26346 + 0.00492]
Epoch 69 [4.0s + 0.3s]: train==[19.13558=19.13065 + 0.00493], recall=[0.26754, 0.62544], precision=[0.09814, 0.05279], hit=[0.78367, 0.98091], ndcg=[0.20357, 0.32122]
Epoch 70 [4.0s]: train==[18.89542=18.89048 + 0.00494]
Epoch 71 [4.0s]: train==[19.31174=19.30678 + 0.00496]
Epoch 72 [4.1s]: train==[19.10540=19.10043 + 0.00497]
Epoch 73 [4.0s]: train==[18.98092=18.97593 + 0.00499]
Epoch 74 [4.1s]: train==[18.72151=18.71652 + 0.00499]
Epoch 75 [4.1s]: train==[18.78979=18.78478 + 0.00501]
Epoch 76 [4.0s]: train==[18.64976=18.64474 + 0.00502]
Epoch 77 [4.1s]: train==[18.58796=18.58294 + 0.00503]
Epoch 78 [4.0s]: train==[18.32115=18.31611 + 0.00505]
Epoch 79 [4.0s + 0.3s]: train==[18.48354=18.47848 + 0.00506], recall=[0.27483, 0.63192], precision=[0.10148, 0.05367], hit=[0.79215, 0.97879], ndcg=[0.21114, 0.32899]
Epoch 80 [4.1s]: train==[18.38838=18.38331 + 0.00507]
Epoch 81 [4.1s]: train==[18.32027=18.31518 + 0.00509]
Epoch 82 [4.1s]: train==[18.58305=18.57796 + 0.00510]
Epoch 83 [4.1s]: train==[18.25144=18.24633 + 0.00511]
Epoch 84 [4.1s]: train==[18.31956=18.31444 + 0.00512]
Epoch 85 [4.1s]: train==[17.96315=17.95801 + 0.00514]
Epoch 86 [4.1s]: train==[18.22160=18.21645 + 0.00515]
Epoch 87 [4.1s]: train==[17.91328=17.90811 + 0.00516]
Epoch 88 [4.1s]: train==[18.11072=18.10554 + 0.00517]
Epoch 89 [4.1s + 0.3s]: train==[17.84308=17.83790 + 0.00518], recall=[0.28080, 0.63640], precision=[0.10599, 0.05467], hit=[0.79639, 0.98303], ndcg=[0.21785, 0.33506]
Epoch 90 [4.1s]: train==[17.82069=17.81550 + 0.00520]
Epoch 91 [4.1s]: train==[17.73385=17.72864 + 0.00521]
Epoch 92 [4.1s]: train==[17.73104=17.72581 + 0.00523]
Epoch 93 [4.0s]: train==[17.38623=17.38099 + 0.00524]
Epoch 94 [4.1s]: train==[17.59709=17.59184 + 0.00525]
Epoch 95 [4.1s]: train==[17.37909=17.37383 + 0.00526]
Epoch 96 [4.1s]: train==[17.58484=17.57958 + 0.00527]
Epoch 97 [4.1s]: train==[17.51837=17.51309 + 0.00529]
Epoch 98 [4.0s]: train==[17.44395=17.43865 + 0.00530]
Epoch 99 [4.1s + 0.3s]: train==[17.04881=17.04349 + 0.00531], recall=[0.28079, 0.64687], precision=[0.10811, 0.05559], hit=[0.79533, 0.97879], ndcg=[0.22211, 0.34225]
Epoch 100 [4.0s]: train==[17.35790=17.35258 + 0.00533]
Epoch 101 [4.1s]: train==[17.26100=17.25567 + 0.00533]
Epoch 102 [4.0s]: train==[17.21555=17.21020 + 0.00535]
Epoch 103 [4.0s]: train==[16.89429=16.88894 + 0.00536]
Epoch 104 [4.0s]: train==[17.08125=17.07588 + 0.00538]
Epoch 105 [4.0s]: train==[17.00448=16.99909 + 0.00539]
Epoch 106 [4.1s]: train==[16.82632=16.82091 + 0.00540]
Epoch 107 [4.0s]: train==[16.90643=16.90102 + 0.00541]
Epoch 108 [4.1s]: train==[16.92758=16.92215 + 0.00543]
Epoch 109 [4.1s + 0.3s]: train==[17.08957=17.08413 + 0.00544], recall=[0.29674, 0.65759], precision=[0.11347, 0.05691], hit=[0.82821, 0.98303], ndcg=[0.23391, 0.35227]
Epoch 110 [4.0s]: train==[16.85987=16.85441 + 0.00545]
Epoch 111 [4.0s]: train==[16.73305=16.72758 + 0.00546]
Epoch 112 [4.0s]: train==[16.62654=16.62106 + 0.00548]
Epoch 113 [4.0s]: train==[16.61294=16.60745 + 0.00549]
Epoch 114 [4.1s]: train==[16.47484=16.46935 + 0.00550]
Epoch 115 [4.1s]: train==[16.61731=16.61179 + 0.00552]
Epoch 116 [4.1s]: train==[16.35028=16.34475 + 0.00553]
Epoch 117 [4.1s]: train==[16.44106=16.43551 + 0.00554]
Epoch 118 [4.1s]: train==[16.26757=16.26201 + 0.00556]
Epoch 119 [4.1s + 0.3s]: train==[16.40963=16.40406 + 0.00557], recall=[0.30454, 0.65599], precision=[0.11718, 0.05673], hit=[0.82185, 0.98091], ndcg=[0.24384, 0.35851]
Epoch 120 [4.1s]: train==[16.28951=16.28394 + 0.00558]
Epoch 121 [4.1s]: train==[16.19624=16.19065 + 0.00559]
Epoch 122 [4.1s]: train==[16.15651=16.15090 + 0.00560]
Epoch 123 [4.1s]: train==[16.05744=16.05183 + 0.00562]
Epoch 124 [4.1s]: train==[16.28976=16.28413 + 0.00562]
Epoch 125 [4.1s]: train==[16.06663=16.06099 + 0.00564]
Epoch 126 [4.1s]: train==[16.12580=16.12014 + 0.00566]
Epoch 127 [4.1s]: train==[16.03206=16.02640 + 0.00567]
Epoch 128 [4.1s]: train==[15.85556=15.84988 + 0.00568]
Epoch 129 [4.1s + 0.3s]: train==[15.94595=15.94026 + 0.00570], recall=[0.30409, 0.65842], precision=[0.11782, 0.05713], hit=[0.82609, 0.97879], ndcg=[0.24346, 0.35914]
Epoch 130 [4.0s]: train==[15.81541=15.80971 + 0.00570]
Epoch 131 [4.0s]: train==[15.66771=15.66199 + 0.00572]
Epoch 132 [4.0s]: train==[15.78104=15.77531 + 0.00573]
Epoch 133 [4.0s]: train==[15.84234=15.83660 + 0.00574]
Epoch 134 [4.0s]: train==[15.72958=15.72383 + 0.00576]
Epoch 135 [4.0s]: train==[15.59576=15.58998 + 0.00578]
Epoch 136 [4.1s]: train==[15.70513=15.69935 + 0.00578]
Epoch 137 [4.0s]: train==[15.66665=15.66085 + 0.00580]
Epoch 138 [4.1s]: train==[15.66785=15.66204 + 0.00581]
Epoch 139 [4.1s + 0.3s]: train==[15.33421=15.32838 + 0.00583], recall=[0.31248, 0.66801], precision=[0.12169, 0.05804], hit=[0.83881, 0.98303], ndcg=[0.25432, 0.36982]
Epoch 140 [4.1s]: train==[15.35367=15.34783 + 0.00584]
Epoch 141 [4.1s]: train==[15.53755=15.53170 + 0.00585]
Epoch 142 [4.1s]: train==[15.43573=15.42987 + 0.00586]
Epoch 143 [4.1s]: train==[15.38013=15.37426 + 0.00587]
Epoch 144 [4.1s]: train==[15.21471=15.20883 + 0.00588]
Epoch 145 [4.1s]: train==[15.35652=15.35063 + 0.00590]
Epoch 146 [4.1s]: train==[15.35167=15.34577 + 0.00590]
Epoch 147 [4.1s]: train==[15.19256=15.18664 + 0.00592]
Epoch 148 [4.3s]: train==[15.34828=15.34233 + 0.00594]
Epoch 149 [4.1s + 0.4s]: train==[15.03887=15.03292 + 0.00595], recall=[0.31198, 0.66627], precision=[0.12269, 0.05815], hit=[0.83033, 0.98409], ndcg=[0.25889, 0.37402]
Best Iter=[13]@[621.9]  recall=[0.31248 0.44357 0.54943 0.61535 0.66801], precision=[0.12169    0.09112 0.07639 0.06540 0.05804], hit=[0.83881  0.92789 0.96713 0.97667 0.98303], ndcg=[0.25432 0.29670    0.33187 0.35314 0.36982]