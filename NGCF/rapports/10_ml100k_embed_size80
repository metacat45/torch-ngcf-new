hephaestos@toto:/media/stock/projets/20220130_CNAM_graphs/NGCF-PyTorch-new/NGCF$ python3 main.py --dataset ml-100k --regs [1e-5] --embed_size 80 --layer_size [64,64,64] --lr 0.0001 --save_flag 0 --pretrain 0 --batch_size 1024 --epoch 150 --verbose 1 --node_dropout [0.1] --mess_dropout [0.1,0.1,0.1]
n_users=943, n_items=1682
n_interactions=100000
n_train=90404, n_test=9596, sparsity=0.06305
already load adj matrix (2625, 2625) 0.018825769424438477
Epoch 0 [4.1s]: train==[61.18929=61.18512 + 0.00416]
Epoch 1 [4.1s]: train==[60.38076=60.37659 + 0.00416]
Epoch 2 [4.9s]: train==[55.22502=55.22086 + 0.00416]
Epoch 3 [4.9s]: train==[47.47606=47.47187 + 0.00417]
Epoch 4 [4.6s]: train==[40.83336=40.82919 + 0.00418]
Epoch 5 [4.8s]: train==[37.17361=37.16943 + 0.00420]
Epoch 6 [4.2s]: train==[34.79382=34.78960 + 0.00421]
Epoch 7 [4.0s]: train==[32.98547=32.98126 + 0.00423]
Epoch 8 [4.1s]: train==[31.74086=31.73662 + 0.00424]
Epoch 9 [4.1s + 0.4s]: train==[30.51387=30.50961 + 0.00426], recall=[0.15775, 0.48447], precision=[0.05483, 0.03838], hit=[0.60870, 0.92577], ndcg=[0.11212, 0.21759]
Epoch 10 [4.2s]: train==[29.49710=29.49282 + 0.00427]
Epoch 11 [4.1s]: train==[28.71919=28.71490 + 0.00429]
Epoch 12 [4.1s]: train==[27.75921=27.75490 + 0.00430]
Epoch 13 [4.1s]: train==[26.75526=26.75094 + 0.00432]
Epoch 14 [4.1s]: train==[26.15009=26.14576 + 0.00433]
Epoch 15 [4.2s]: train==[25.77952=25.77516 + 0.00435]
Epoch 16 [4.0s]: train==[25.28525=25.28089 + 0.00437]
Epoch 17 [4.1s]: train==[24.86014=24.85575 + 0.00438]
Epoch 18 [4.1s]: train==[24.39996=24.39556 + 0.00440]
Epoch 19 [4.1s + 0.4s]: train==[24.18873=24.18431 + 0.00442], recall=[0.21314, 0.55587], precision=[0.07672, 0.04641], hit=[0.69353, 0.95652], ndcg=[0.15249, 0.26556]
Epoch 20 [4.3s]: train==[23.66353=23.65910 + 0.00443]
Epoch 21 [4.2s]: train==[23.42805=23.42360 + 0.00445]
Epoch 22 [4.0s]: train==[22.99166=22.98720 + 0.00447]
Epoch 23 [4.1s]: train==[23.03983=23.03536 + 0.00448]
Epoch 24 [4.0s]: train==[23.01966=23.01516 + 0.00450]
Epoch 25 [4.0s]: train==[22.48453=22.48001 + 0.00452]
Epoch 26 [4.0s]: train==[22.30867=22.30414 + 0.00453]
Epoch 27 [4.0s]: train==[22.00868=22.00415 + 0.00455]
Epoch 28 [4.0s]: train==[21.76339=21.75883 + 0.00456]
Epoch 29 [4.1s + 0.4s]: train==[21.52315=21.51856 + 0.00458], recall=[0.23763, 0.58548], precision=[0.08558, 0.04885], hit=[0.74019, 0.96819], ndcg=[0.17332, 0.28791]
Epoch 30 [4.1s]: train==[21.49925=21.49466 + 0.00460]
Epoch 31 [4.2s]: train==[21.51731=21.51270 + 0.00461]
Epoch 32 [4.0s]: train==[21.32850=21.32387 + 0.00463]
Epoch 33 [4.0s]: train==[21.26723=21.26259 + 0.00465]
Epoch 34 [4.0s]: train==[21.01633=21.01166 + 0.00466]
Epoch 35 [4.1s]: train==[20.87654=20.87187 + 0.00468]
Epoch 36 [4.1s]: train==[20.66520=20.66050 + 0.00470]
Epoch 37 [4.1s]: train==[20.65590=20.65119 + 0.00472]
Epoch 38 [4.1s]: train==[20.74534=20.74061 + 0.00473]
Epoch 39 [4.1s + 0.4s]: train==[20.47025=20.46550 + 0.00475], recall=[0.24856, 0.60611], precision=[0.08971, 0.05084], hit=[0.76458, 0.97455], ndcg=[0.18163, 0.30011]
Epoch 40 [4.2s]: train==[20.41535=20.41058 + 0.00477]
Epoch 41 [4.5s]: train==[20.21032=20.20553 + 0.00479]
Epoch 42 [5.8s]: train==[20.18028=20.17547 + 0.00480]
Epoch 43 [6.5s]: train==[20.13207=20.12725 + 0.00482]
Epoch 44 [5.2s]: train==[19.97068=19.96584 + 0.00484]
Epoch 45 [5.1s]: train==[19.79432=19.78947 + 0.00486]
Epoch 46 [5.4s]: train==[19.82507=19.82019 + 0.00487]
Epoch 47 [4.3s]: train==[19.65681=19.65192 + 0.00489]
Epoch 48 [4.3s]: train==[19.40391=19.39900 + 0.00491]
Epoch 49 [4.3s + 0.4s]: train==[19.69522=19.69029 + 0.00493], recall=[0.25734, 0.61735], precision=[0.09475, 0.05242], hit=[0.77625, 0.97243], ndcg=[0.19352, 0.31216]
Epoch 50 [4.8s]: train==[19.24372=19.23877 + 0.00494]
Epoch 51 [4.2s]: train==[19.40309=19.39812 + 0.00496]
Epoch 52 [4.3s]: train==[19.21424=19.20926 + 0.00498]
Epoch 53 [4.3s]: train==[19.00691=19.00191 + 0.00500]
Epoch 54 [4.7s]: train==[18.92704=18.92202 + 0.00502]
Epoch 55 [4.3s]: train==[18.64025=18.63521 + 0.00504]
Epoch 56 [4.1s]: train==[18.73395=18.72889 + 0.00506]
Epoch 57 [4.4s]: train==[18.42500=18.41992 + 0.00507]
Epoch 58 [4.5s]: train==[18.67320=18.66811 + 0.00509]
Epoch 59 [4.2s + 0.5s]: train==[18.37615=18.37105 + 0.00511], recall=[0.27635, 0.63528], precision=[0.10509, 0.05444], hit=[0.79533, 0.97879], ndcg=[0.21603, 0.33275]
Epoch 60 [4.1s]: train==[18.53221=18.52709 + 0.00513]
Epoch 61 [4.3s]: train==[18.56666=18.56152 + 0.00515]
Epoch 62 [4.0s]: train==[18.19644=18.19128 + 0.00516]
Epoch 63 [4.2s]: train==[18.02962=18.02444 + 0.00518]
Epoch 64 [4.1s]: train==[17.84135=17.83615 + 0.00520]
Epoch 65 [4.1s]: train==[17.90167=17.89645 + 0.00522]
Epoch 66 [4.3s]: train==[17.81017=17.80494 + 0.00524]
Epoch 67 [4.0s]: train==[17.52898=17.52372 + 0.00526]
Epoch 68 [4.1s]: train==[17.34596=17.34068 + 0.00528]
Epoch 69 [4.1s + 0.4s]: train==[17.41883=17.41354 + 0.00529], recall=[0.27697, 0.64078], precision=[0.10928, 0.05546], hit=[0.79639, 0.98197], ndcg=[0.21635, 0.33440]
Epoch 70 [4.4s]: train==[17.24359=17.23828 + 0.00531]
Epoch 71 [4.1s]: train==[17.20808=17.20274 + 0.00534]
Epoch 72 [4.2s]: train==[17.19725=17.19190 + 0.00535]
Epoch 73 [4.0s]: train==[17.32945=17.32409 + 0.00536]
Epoch 74 [4.1s]: train==[17.08916=17.08377 + 0.00538]
Epoch 75 [4.1s]: train==[17.14609=17.14068 + 0.00541]
Epoch 76 [4.0s]: train==[16.99195=16.98654 + 0.00542]
Epoch 77 [4.1s]: train==[16.95993=16.95448 + 0.00544]
Epoch 78 [4.1s]: train==[16.77490=16.76944 + 0.00546]
Epoch 79 [4.0s + 0.4s]: train==[16.68587=16.68040 + 0.00548], recall=[0.29637, 0.65363], precision=[0.11389, 0.05666], hit=[0.82291, 0.97773], ndcg=[0.23690, 0.35377]
Epoch 80 [4.0s]: train==[16.65090=16.64540 + 0.00550]
Epoch 81 [4.0s]: train==[16.49354=16.48803 + 0.00551]
Epoch 82 [4.0s]: train==[16.47815=16.47261 + 0.00554]
Epoch 83 [4.0s]: train==[16.37128=16.36572 + 0.00556]
Epoch 84 [4.0s]: train==[16.53328=16.52771 + 0.00557]
Epoch 85 [4.1s]: train==[16.25067=16.24508 + 0.00559]
Epoch 86 [4.1s]: train==[16.33128=16.32568 + 0.00560]
Epoch 87 [4.1s]: train==[16.31306=16.30744 + 0.00563]
Epoch 88 [4.0s]: train==[16.21540=16.20976 + 0.00564]
Epoch 89 [4.1s + 0.4s]: train==[16.13441=16.12873 + 0.00567], recall=[0.30618, 0.65972], precision=[0.12004, 0.05723], hit=[0.82927, 0.98091], ndcg=[0.24901, 0.36333]
Epoch 90 [4.0s]: train==[15.86581=15.86013 + 0.00568]
Epoch 91 [4.1s]: train==[15.99921=15.99351 + 0.00570]
Epoch 92 [4.3s]: train==[16.13618=16.13046 + 0.00571]
Epoch 93 [4.0s]: train==[15.78765=15.78192 + 0.00573]
Epoch 94 [4.0s]: train==[15.80443=15.79867 + 0.00576]
Epoch 95 [4.1s]: train==[15.64096=15.63519 + 0.00577]
Epoch 96 [4.0s]: train==[15.61148=15.60568 + 0.00579]
Epoch 97 [4.0s]: train==[15.64041=15.63460 + 0.00581]
Epoch 98 [4.1s]: train==[15.51092=15.50508 + 0.00583]
Epoch 99 [4.2s + 0.4s]: train==[15.51744=15.51159 + 0.00585], recall=[0.30994, 0.66738], precision=[0.12195, 0.05828], hit=[0.83987, 0.97985], ndcg=[0.25304, 0.36856]
Epoch 100 [4.1s]: train==[15.53159=15.52572 + 0.00587]
Epoch 101 [4.1s]: train==[15.42033=15.41444 + 0.00588]
Epoch 102 [4.1s]: train==[15.42481=15.41891 + 0.00591]
Epoch 103 [4.1s]: train==[15.24138=15.23545 + 0.00593]
Epoch 104 [4.1s]: train==[15.19726=15.19132 + 0.00594]
Epoch 105 [4.1s]: train==[15.14961=15.14366 + 0.00596]
Epoch 106 [4.0s]: train==[15.25585=15.24987 + 0.00597]
Epoch 107 [4.0s]: train==[15.01156=15.00555 + 0.00600]
Epoch 108 [4.0s]: train==[15.07781=15.07179 + 0.00602]
Epoch 109 [4.1s + 0.4s]: train==[15.10151=15.09548 + 0.00603], recall=[0.31405, 0.67176], precision=[0.12444, 0.05854], hit=[0.83987, 0.98303], ndcg=[0.25980, 0.37458]
Epoch 110 [4.1s]: train==[15.22219=15.21614 + 0.00605]
Epoch 111 [4.1s]: train==[14.78789=14.78182 + 0.00607]
Epoch 112 [4.1s]: train==[14.60686=14.60077 + 0.00609]
Epoch 113 [4.1s]: train==[14.92704=14.92094 + 0.00610]
Epoch 114 [4.1s]: train==[14.79342=14.78729 + 0.00613]
Epoch 115 [4.1s]: train==[14.73938=14.73323 + 0.00614]
Epoch 116 [4.1s]: train==[14.73417=14.72801 + 0.00617]
Epoch 117 [4.1s]: train==[14.60140=14.59521 + 0.00619]
Epoch 118 [4.1s]: train==[14.60263=14.59642 + 0.00620]
Epoch 119 [4.1s + 0.4s]: train==[14.43840=14.43217 + 0.00623], recall=[0.31805, 0.67524], precision=[0.12704, 0.05927], hit=[0.84199, 0.98303], ndcg=[0.26428, 0.37867]
Epoch 120 [4.1s]: train==[14.33758=14.33135 + 0.00623]
Epoch 121 [4.1s]: train==[14.30700=14.30075 + 0.00626]
Epoch 122 [4.1s]: train==[14.37550=14.36922 + 0.00628]
Epoch 123 [4.1s]: train==[14.41499=14.40870 + 0.00629]
Epoch 124 [4.1s]: train==[14.36362=14.35730 + 0.00632]
Epoch 125 [4.1s]: train==[14.28974=14.28341 + 0.00633]
Epoch 126 [4.1s]: train==[14.37559=14.36924 + 0.00635]
Epoch 127 [4.1s]: train==[14.32437=14.31801 + 0.00636]
Epoch 128 [4.1s]: train==[14.18806=14.18167 + 0.00639]
Epoch 129 [4.1s + 0.4s]: train==[14.28880=14.28240 + 0.00641], recall=[0.31984, 0.67888], precision=[0.12773, 0.05971], hit=[0.84411, 0.98197], ndcg=[0.26863, 0.38365]
Epoch 130 [4.1s]: train==[14.05488=14.04844 + 0.00643]
Epoch 131 [4.2s]: train==[14.02993=14.02349 + 0.00644]
Epoch 132 [4.1s]: train==[14.13022=14.12375 + 0.00646]
Epoch 133 [4.2s]: train==[13.96561=13.95914 + 0.00648]
Epoch 134 [4.2s]: train==[14.02036=14.01386 + 0.00650]
Epoch 135 [4.4s]: train==[13.88978=13.88327 + 0.00651]
Epoch 136 [4.3s]: train==[13.82234=13.81581 + 0.00653]
Epoch 137 [4.1s]: train==[13.89107=13.88451 + 0.00656]
Epoch 138 [4.2s]: train==[13.77857=13.77200 + 0.00657]
Epoch 139 [4.2s + 0.4s]: train==[13.76145=13.75487 + 0.00659], recall=[0.32254, 0.67884], precision=[0.13075, 0.06004], hit=[0.84411, 0.98197], ndcg=[0.27196, 0.38589]
Epoch 140 [4.1s]: train==[13.49912=13.49250 + 0.00661]
Epoch 141 [4.1s]: train==[13.55520=13.54857 + 0.00662]
Epoch 142 [4.1s]: train==[13.69583=13.68920 + 0.00663]
Epoch 143 [4.1s]: train==[13.53367=13.52699 + 0.00668]
Epoch 144 [4.2s]: train==[13.56072=13.55404 + 0.00668]
Epoch 145 [4.1s]: train==[13.23647=13.22977 + 0.00670]
Epoch 146 [4.1s]: train==[13.43894=13.43222 + 0.00673]
Epoch 147 [4.2s]: train==[13.53610=13.52936 + 0.00673]
Epoch 148 [4.3s]: train==[13.22647=13.21971 + 0.00676]
Epoch 149 [4.2s + 0.4s]: train==[13.39503=13.38826 + 0.00678], recall=[0.32743, 0.68807], precision=[0.13298, 0.06084], hit=[0.85472, 0.98303], ndcg=[0.27572, 0.39073]
Best Iter=[14]@[635.6]  recall=[0.32743 0.46405 0.56577 0.63496 0.68807], precision=[0.13298    0.09764 0.08066 0.06913 0.06084], hit=[0.85472  0.93743 0.96713 0.97667 0.98303], ndcg=[0.27572 0.31775    0.35171 0.37417 0.39073]