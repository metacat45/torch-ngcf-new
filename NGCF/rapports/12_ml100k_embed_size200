hephaestos@toto:/media/stock/projets/20220130_CNAM_graphs/NGCF-PyTorch-new/NGCF$ python3 main.py --dataset ml-100k --regs [1e-5] --embed_size 200 --layer_size [64,64,64] --lr 0.0001 --save_flag 0 --pretrain 0 --batch_size 1024 --epoch 200 --verbose 1 --node_dropout [0.1] --mess_dropout [0.1,0.1,0.1]
n_users=943, n_items=1682
n_interactions=100000
n_train=90404, n_test=9596, sparsity=0.06305
already load adj matrix (2625, 2625) 0.018850088119506836
Epoch 0 [4.2s]: train==[61.20846=61.20412 + 0.00435]
Epoch 1 [4.2s]: train==[60.28656=60.28221 + 0.00435]
Epoch 2 [4.1s]: train==[53.30198=53.29763 + 0.00436]
Epoch 3 [4.1s]: train==[42.42973=42.42537 + 0.00437]
Epoch 4 [4.1s]: train==[36.57423=36.56984 + 0.00439]
Epoch 5 [4.1s]: train==[33.87197=33.86756 + 0.00441]
Epoch 6 [4.2s]: train==[32.01188=32.00746 + 0.00443]
Epoch 7 [4.3s]: train==[30.33542=30.33097 + 0.00445]
Epoch 8 [4.7s]: train==[28.80280=28.79833 + 0.00447]
Epoch 9 [4.2s + 0.4s]: train==[27.78655=27.78206 + 0.00449], recall=[0.17620, 0.51602], precision=[0.06214, 0.04172], hit=[0.63521, 0.94380], ndcg=[0.11523, 0.22688]
Epoch 10 [4.2s]: train==[26.78413=26.77962 + 0.00451]
Epoch 11 [4.1s]: train==[25.86720=25.86267 + 0.00453]
Epoch 12 [4.1s]: train==[25.14251=25.13796 + 0.00455]
Epoch 13 [4.2s]: train==[24.63630=24.63173 + 0.00457]
Epoch 14 [4.9s]: train==[24.06141=24.05680 + 0.00460]
Epoch 15 [4.2s]: train==[23.78098=23.77636 + 0.00462]
Epoch 16 [4.2s]: train==[23.16846=23.16383 + 0.00464]
Epoch 17 [4.4s]: train==[22.90456=22.89990 + 0.00466]
Epoch 18 [4.3s]: train==[22.63914=22.63445 + 0.00468]
Epoch 19 [4.5s + 0.5s]: train==[22.39515=22.39045 + 0.00471], recall=[0.21637, 0.57678], precision=[0.08075, 0.04789], hit=[0.72216, 0.96501], ndcg=[0.16048, 0.27804]
Epoch 20 [4.4s]: train==[22.11049=22.10577 + 0.00473]
Epoch 21 [5.3s]: train==[22.05010=22.04535 + 0.00475]
Epoch 22 [4.2s]: train==[21.75701=21.75224 + 0.00477]
Epoch 23 [4.2s]: train==[21.48037=21.47558 + 0.00479]
Epoch 24 [4.2s]: train==[21.23912=21.23431 + 0.00482]
Epoch 25 [4.3s]: train==[21.30391=21.29907 + 0.00484]
Epoch 26 [4.3s]: train==[20.96259=20.95773 + 0.00486]
Epoch 27 [4.5s]: train==[20.95066=20.94577 + 0.00489]
Epoch 28 [4.2s]: train==[20.79288=20.78797 + 0.00491]
Epoch 29 [4.4s + 0.4s]: train==[20.46453=20.45960 + 0.00493], recall=[0.24346, 0.59988], precision=[0.08834, 0.04996], hit=[0.74761, 0.97455], ndcg=[0.18078, 0.29777]
Epoch 30 [4.1s]: train==[20.47243=20.46748 + 0.00496]
Epoch 31 [4.2s]: train==[20.19905=20.19406 + 0.00499]
Epoch 32 [4.1s]: train==[20.03353=20.02852 + 0.00501]
Epoch 33 [4.1s]: train==[19.87989=19.87485 + 0.00504]
Epoch 34 [4.0s]: train==[19.92539=19.92032 + 0.00506]
Epoch 35 [4.1s]: train==[19.78886=19.78377 + 0.00509]
Epoch 36 [4.4s]: train==[19.64014=19.63503 + 0.00511]
Epoch 37 [4.2s]: train==[19.39770=19.39255 + 0.00514]
Epoch 38 [4.2s]: train==[19.37417=19.36900 + 0.00517]
Epoch 39 [4.5s + 0.4s]: train==[19.08529=19.08008 + 0.00520], recall=[0.26429, 0.62497], precision=[0.09836, 0.05282], hit=[0.78579, 0.98091], ndcg=[0.19971, 0.31795]
Epoch 40 [4.7s]: train==[18.91746=18.91223 + 0.00523]
Epoch 41 [4.3s]: train==[18.65965=18.65439 + 0.00526]
Epoch 42 [4.7s]: train==[18.78980=18.78451 + 0.00529]
Epoch 43 [4.8s]: train==[18.29036=18.28505 + 0.00531]
Epoch 44 [4.6s]: train==[18.47169=18.46634 + 0.00535]
Epoch 45 [4.2s]: train==[18.24397=18.23859 + 0.00537]
Epoch 46 [4.1s]: train==[17.89907=17.89367 + 0.00540]
Epoch 47 [4.1s]: train==[17.82694=17.82150 + 0.00543]
Epoch 48 [4.1s]: train==[17.58545=17.57997 + 0.00547]
Epoch 49 [4.1s + 0.4s]: train==[17.44676=17.44126 + 0.00550], recall=[0.28477, 0.64209], precision=[0.11007, 0.05517], hit=[0.80912, 0.98409], ndcg=[0.22493, 0.34080]
Epoch 50 [4.0s]: train==[17.30945=17.30392 + 0.00553]
Epoch 51 [4.1s]: train==[17.15886=17.15330 + 0.00556]
Epoch 52 [4.0s]: train==[16.98172=16.97613 + 0.00559]
Epoch 53 [4.1s]: train==[17.13577=17.13014 + 0.00562]
Epoch 54 [4.0s]: train==[16.60237=16.59671 + 0.00565]
Epoch 55 [4.2s]: train==[16.70525=16.69956 + 0.00569]
Epoch 56 [4.1s]: train==[16.46811=16.46239 + 0.00572]
Epoch 57 [4.1s]: train==[16.54224=16.53649 + 0.00575]
Epoch 58 [4.3s]: train==[16.18424=16.17846 + 0.00579]
Epoch 59 [4.2s + 0.4s]: train==[16.11589=16.11007 + 0.00582], recall=[0.30465, 0.65743], precision=[0.11803, 0.05718], hit=[0.82503, 0.98303], ndcg=[0.24634, 0.36136]
Epoch 60 [4.3s]: train==[15.81469=15.80883 + 0.00586]
Epoch 61 [4.1s]: train==[15.87576=15.86988 + 0.00588]
Epoch 62 [4.1s]: train==[15.77122=15.76530 + 0.00592]
Epoch 63 [4.1s]: train==[15.60052=15.59457 + 0.00595]
Epoch 64 [4.1s]: train==[15.56968=15.56370 + 0.00599]
Epoch 65 [4.3s]: train==[15.50242=15.49641 + 0.00601]
Epoch 66 [4.2s]: train==[15.29114=15.28509 + 0.00605]
Epoch 67 [4.1s]: train==[15.28938=15.28330 + 0.00608]
Epoch 68 [4.3s]: train==[15.02740=15.02129 + 0.00612]
Epoch 69 [4.2s + 0.4s]: train==[15.01060=15.00445 + 0.00615], recall=[0.31633, 0.66494], precision=[0.12301, 0.05801], hit=[0.84305, 0.98515], ndcg=[0.25847, 0.37192]
Epoch 70 [4.1s]: train==[15.04800=15.04181 + 0.00619]
Epoch 71 [4.2s]: train==[14.73700=14.73078 + 0.00622]
Epoch 72 [4.1s]: train==[14.99877=14.99252 + 0.00625]
Epoch 73 [4.2s]: train==[14.75090=14.74462 + 0.00628]
Epoch 74 [4.2s]: train==[14.59941=14.59308 + 0.00632]
Epoch 75 [4.2s]: train==[14.51731=14.51095 + 0.00636]
Epoch 76 [4.1s]: train==[14.46844=14.46204 + 0.00639]
Epoch 77 [4.2s]: train==[14.36252=14.35610 + 0.00642]
Epoch 78 [4.1s]: train==[14.07432=14.06786 + 0.00646]
Epoch 79 [4.2s + 0.4s]: train==[14.11009=14.10359 + 0.00649], recall=[0.32236, 0.67141], precision=[0.12587, 0.05896], hit=[0.84517, 0.98197], ndcg=[0.26467, 0.37826]
Epoch 80 [4.1s]: train==[14.13574=14.12922 + 0.00653]
Epoch 81 [4.2s]: train==[13.89333=13.88677 + 0.00656]
Epoch 82 [4.2s]: train==[13.97787=13.97127 + 0.00660]
Epoch 83 [4.2s]: train==[14.02320=14.01657 + 0.00663]
Epoch 84 [4.3s]: train==[13.82452=13.81785 + 0.00667]
Epoch 85 [4.3s]: train==[13.84493=13.83823 + 0.00670]
Epoch 86 [4.2s]: train==[13.50622=13.49949 + 0.00673]
Epoch 87 [4.2s]: train==[13.48028=13.47352 + 0.00677]
Epoch 88 [4.1s]: train==[13.45357=13.44677 + 0.00680]
Epoch 89 [4.2s + 0.4s]: train==[13.30625=13.29941 + 0.00683], recall=[0.32569, 0.67971], precision=[0.12990, 0.06005], hit=[0.84942, 0.98515], ndcg=[0.27364, 0.38817]
Epoch 90 [4.2s]: train==[13.45944=13.45257 + 0.00687]
Epoch 91 [4.2s]: train==[13.24393=13.23703 + 0.00690]
Epoch 92 [4.2s]: train==[13.20878=13.20185 + 0.00693]
Epoch 93 [4.4s]: train==[13.11088=13.10391 + 0.00697]
Epoch 94 [4.5s]: train==[13.04753=13.04052 + 0.00701]
Epoch 95 [4.4s]: train==[12.97857=12.97153 + 0.00704]
Epoch 96 [4.3s]: train==[12.83837=12.83130 + 0.00707]
Epoch 97 [4.4s]: train==[12.84958=12.84247 + 0.00710]
Epoch 98 [4.4s]: train==[12.64990=12.64275 + 0.00714]
Epoch 99 [4.3s + 0.4s]: train==[12.78144=12.77427 + 0.00718], recall=[0.32753, 0.68446], precision=[0.13314, 0.06043], hit=[0.84730, 0.98727], ndcg=[0.27848, 0.39274]
Epoch 100 [4.3s]: train==[12.63589=12.62868 + 0.00722]
Epoch 101 [4.3s]: train==[12.51020=12.50295 + 0.00724]
Epoch 102 [4.2s]: train==[12.55378=12.54649 + 0.00729]
Epoch 103 [4.2s]: train==[12.51004=12.50273 + 0.00731]
Epoch 104 [4.3s]: train==[12.44397=12.43663 + 0.00735]
Epoch 105 [4.5s]: train==[12.39301=12.38563 + 0.00738]
Epoch 106 [4.3s]: train==[12.22548=12.21807 + 0.00742]
Epoch 107 [4.4s]: train==[12.16718=12.15973 + 0.00745]
Epoch 108 [4.2s]: train==[12.13701=12.12953 + 0.00748]
Epoch 109 [4.3s + 0.4s]: train==[12.00326=11.99575 + 0.00752], recall=[0.33447, 0.68927], precision=[0.13738, 0.06113], hit=[0.85154, 0.98303], ndcg=[0.28552, 0.39867]
Epoch 110 [4.3s]: train==[11.98392=11.97637 + 0.00755]
Epoch 111 [4.3s]: train==[12.03376=12.02617 + 0.00758]
Epoch 112 [4.3s]: train==[11.87984=11.87222 + 0.00762]
Epoch 113 [4.1s]: train==[11.91068=11.90304 + 0.00765]
Epoch 114 [4.1s]: train==[11.70443=11.69675 + 0.00768]
Epoch 115 [4.1s]: train==[11.68917=11.68145 + 0.00772]
Epoch 116 [4.1s]: train==[11.84839=11.84063 + 0.00776]
Epoch 117 [4.2s]: train==[11.67598=11.66820 + 0.00779]
Epoch 118 [4.1s]: train==[11.42880=11.42098 + 0.00782]
Epoch 119 [4.2s + 0.4s]: train==[11.57069=11.56281 + 0.00787], recall=[0.34090, 0.69402], precision=[0.14088, 0.06176], hit=[0.86532, 0.98515], ndcg=[0.28988, 0.40232]
Epoch 120 [4.3s]: train==[11.49597=11.48808 + 0.00788]
Epoch 121 [4.3s]: train==[11.38327=11.37534 + 0.00793]
Epoch 122 [4.3s]: train==[11.48122=11.47326 + 0.00795]
Epoch 123 [4.3s]: train==[11.17585=11.16786 + 0.00799]
Epoch 124 [4.2s]: train==[11.18269=11.17467 + 0.00802]
Epoch 125 [4.2s]: train==[11.14668=11.13863 + 0.00805]
Epoch 126 [4.2s]: train==[11.05142=11.04332 + 0.00810]
Epoch 127 [4.2s]: train==[11.06854=11.06041 + 0.00813]
Epoch 128 [4.1s]: train==[11.18209=11.17394 + 0.00815]
Epoch 129 [4.2s + 0.4s]: train==[11.08007=11.07188 + 0.00819], recall=[0.34501, 0.70061], precision=[0.14374, 0.06264], hit=[0.86426, 0.98515], ndcg=[0.29740, 0.41044]
Epoch 130 [4.0s]: train==[10.95410=10.94587 + 0.00823]
Epoch 131 [4.0s]: train==[10.81375=10.80549 + 0.00827]
Epoch 132 [4.1s]: train==[10.80648=10.79818 + 0.00829]
Epoch 133 [4.0s]: train==[10.73171=10.72338 + 0.00833]
Epoch 134 [4.0s]: train==[10.73638=10.72801 + 0.00837]
Epoch 135 [4.0s]: train==[10.58652=10.57813 + 0.00839]
Epoch 136 [4.1s]: train==[10.45603=10.44761 + 0.00843]
Epoch 137 [4.2s]: train==[10.57811=10.56965 + 0.00846]
Epoch 138 [4.3s]: train==[10.51677=10.50828 + 0.00849]
Epoch 139 [4.2s + 0.4s]: train==[10.60981=10.60128 + 0.00852], recall=[0.34799, 0.70631], precision=[0.14586, 0.06318], hit=[0.87169, 0.98727], ndcg=[0.30145, 0.41496]
Epoch 140 [4.1s]: train==[10.28475=10.27619 + 0.00856]
Epoch 141 [4.2s]: train==[10.23881=10.23022 + 0.00859]
Epoch 142 [4.2s]: train==[10.14143=10.13279 + 0.00863]
Epoch 143 [4.1s]: train==[10.30119=10.29252 + 0.00867]
Epoch 144 [4.1s]: train==[10.37615=10.36746 + 0.00870]
Epoch 145 [4.1s]: train==[9.98471=9.97598 + 0.00873]
Epoch 146 [4.1s]: train==[9.99922=9.99045 + 0.00877]
Epoch 147 [4.1s]: train==[9.94742=9.93862 + 0.00881]
Epoch 148 [4.1s]: train==[9.94083=9.93200 + 0.00883]
Epoch 149 [4.1s + 0.4s]: train==[10.04231=10.03343 + 0.00887], recall=[0.35324, 0.71158], precision=[0.14719, 0.06388], hit=[0.87063, 0.98621], ndcg=[0.30627, 0.42033]
Epoch 150 [4.1s]: train==[10.01614=10.00724 + 0.00889]
Epoch 151 [4.1s]: train==[9.91795=9.90902 + 0.00893]
Epoch 152 [4.1s]: train==[9.79907=9.79010 + 0.00897]
Epoch 153 [4.0s]: train==[9.79617=9.78717 + 0.00900]
Epoch 154 [4.1s]: train==[9.58238=9.57335 + 0.00903]
Epoch 155 [4.1s]: train==[9.64286=9.63380 + 0.00907]
Epoch 156 [4.1s]: train==[9.77009=9.76098 + 0.00910]
Epoch 157 [4.1s]: train==[9.69880=9.68967 + 0.00913]
Epoch 158 [4.1s]: train==[9.54507=9.53589 + 0.00918]
Epoch 159 [4.1s + 0.4s]: train==[9.64279=9.63359 + 0.00920], recall=[0.36090, 0.71614], precision=[0.15106, 0.06422], hit=[0.88123, 0.98621], ndcg=[0.31064, 0.42289]
Epoch 160 [4.1s]: train==[9.42465=9.41541 + 0.00924]
Epoch 161 [4.1s]: train==[9.58375=9.57449 + 0.00926]
Epoch 162 [4.1s]: train==[9.41071=9.40141 + 0.00930]
Epoch 163 [4.0s]: train==[9.32600=9.31668 + 0.00933]
Epoch 164 [4.1s]: train==[9.21611=9.20674 + 0.00936]
Epoch 165 [4.1s]: train==[9.42290=9.41349 + 0.00940]
Epoch 166 [4.1s]: train==[9.24300=9.23356 + 0.00943]
Epoch 167 [4.1s]: train==[9.12216=9.11268 + 0.00947]
Epoch 168 [4.1s]: train==[9.08262=9.07312 + 0.00950]
Epoch 169 [4.1s + 0.4s]: train==[9.03866=9.02913 + 0.00954], recall=[0.36544, 0.72032], precision=[0.15138, 0.06461], hit=[0.88547, 0.98621], ndcg=[0.31413, 0.42685]
Epoch 170 [4.1s]: train==[9.15156=9.14199 + 0.00957]
Epoch 171 [4.1s]: train==[9.04014=9.03053 + 0.00961]
Epoch 172 [4.1s]: train==[9.00732=8.99769 + 0.00963]
Epoch 173 [4.1s]: train==[8.92437=8.91470 + 0.00967]
Epoch 174 [4.1s]: train==[9.05824=9.04855 + 0.00969]
Epoch 175 [4.1s]: train==[8.80524=8.79551 + 0.00973]
Epoch 176 [4.1s]: train==[8.73195=8.72219 + 0.00976]
Epoch 177 [4.1s]: train==[8.77374=8.76394 + 0.00980]
Epoch 178 [4.1s]: train==[8.69472=8.68489 + 0.00984]
Epoch 179 [4.1s + 0.4s]: train==[8.72661=8.71674 + 0.00987], recall=[0.36698, 0.72419], precision=[0.15392, 0.06519], hit=[0.88441, 0.98727], ndcg=[0.32011, 0.43324]
Epoch 180 [4.1s]: train==[8.77638=8.76648 + 0.00990]
Epoch 181 [4.0s]: train==[8.63626=8.62633 + 0.00993]
Epoch 182 [4.0s]: train==[8.59068=8.58072 + 0.00997]
Epoch 183 [4.0s]: train==[8.46530=8.45529 + 0.01001]
Epoch 184 [4.1s]: train==[8.52952=8.51948 + 0.01004]
Epoch 185 [4.1s]: train==[8.42316=8.41308 + 0.01007]
Epoch 186 [4.1s]: train==[8.46494=8.45483 + 0.01011]
Epoch 187 [4.1s]: train==[8.39368=8.38355 + 0.01014]
Epoch 188 [4.1s]: train==[8.41814=8.40797 + 0.01017]
Epoch 189 [4.1s + 0.4s]: train==[8.20535=8.19515 + 0.01020], recall=[0.36792, 0.72466], precision=[0.15371, 0.06509], hit=[0.89183, 0.98834], ndcg=[0.32041, 0.43330]
Epoch 190 [4.0s]: train==[8.43074=8.42051 + 0.01023]
Epoch 191 [4.1s]: train==[8.33257=8.32229 + 0.01028]
Epoch 192 [4.0s]: train==[8.29738=8.28708 + 0.01030]
Epoch 193 [4.1s]: train==[8.18224=8.17191 + 0.01033]
Epoch 194 [4.0s]: train==[8.22780=8.21744 + 0.01037]
Epoch 195 [4.1s]: train==[8.17801=8.16761 + 0.01040]
Epoch 196 [4.1s]: train==[8.01669=8.00626 + 0.01044]
Epoch 197 [4.1s]: train==[8.08539=8.07491 + 0.01047]
Epoch 198 [4.0s]: train==[8.11358=8.10309 + 0.01049]
Epoch 199 [4.1s + 0.4s]: train==[7.93024=7.91970 + 0.01054], recall=[0.36899, 0.72569], precision=[0.15530, 0.06538], hit=[0.88229, 0.98727], ndcg=[0.32405, 0.43669]
Best Iter=[19]@[845.2]  recall=[0.36899 0.51906 0.61106 0.67961 0.72569], precision=[0.15530    0.11100 0.08885 0.07515 0.06538], hit=[0.88229  0.94910 0.97031 0.98197 0.98727], ndcg=[0.32405 0.36850    0.39972 0.42173 0.43669]
hephaestos@toto:/media/stock/projets/20220130_CNAM_graphs/NGCF-PyTorch-new/NGCF$ 